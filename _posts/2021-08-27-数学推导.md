---
layout: article
title: 数学推导
subtitle: 数学注重的不是默写模板，而是需要有推导思维🤔
categories: 推导
tags: [推导]
aside:
  toc: true
sidebar:
  nav: docs-en
---

- <a href="#qst1"><font size="4px">已知一个式子： $S_n=\left\lceil (a+\sqrt b)^n\right\rceil\%m$ ,求递推式</font></a>
- <a href="#qst2"><font size="4px">试证明 $\prod\limits_{x=1}^{n-1}([gcd(x,n)=1]\times x)\% n=1$</font></a>
- <a href="#qst3"><font size="4px">对方程 $f(k)=\sum\limits_{i_1=L}^H\sum\limits_{i_2=L}^H...\sum\limits_{i_n=L}^H[gcd(i_1,i_2,...,i_n)=k]$ 化简时间复杂度</font></a>
<br /><br /><br /><br /><br /><br />


# <font size="6px" id="qst1"><b>已知一个式子： $S_n=\left\lceil (a+\sqrt b)^n\right\rceil\%m$ ,求递推式</b></font>

<table>
<tr>
<td>Thoughts</td><td>Solution</td>
</tr>
<tr>
<td> 根据<mark>二项式定理</mark>，可以设计以下两个式子 </td><td> $(a+\sqrt b)^n=A_n+B_n\sqrt b$ <br /> $(a-\sqrt b)^n=A_n-B_n\sqrt b$ </td>
</tr>
<tr>
<td> 通过转换来的式子合并一下  </td><td> <mark>$(a+\sqrt b)^n+(a-\sqrt b)^n=2A_n$</mark><br>$(a+\sqrt b)^n=2A_n-(a-\sqrt b)^n$  </td>
</tr>
<tr>
<td>利用限制条件有</td><td> $\because a-1\lt \sqrt b\lt a$ <br /> $\therefore 0\lt a-\sqrt b\lt 0$ <br /> $\therefore (a+\sqrt b)^n=2A_n-(a-\sqrt b)^n\left\{\begin{aligned} 
&\lt 2A_n \\ 
&\gt 2A_n-1\end{aligned}\right. 
\Rightarrow \left\lceil(a+\sqrt b)^n\right\rceil=2A_n$ </td>
</tr>
<tr>
<td>得到新式</td><td>$\left\lceil(a+\sqrt b)^n\right\rceil=2A_n=(a+\sqrt b)^n+(a-\sqrt b)^n$</td>
</tr>
<tr>
<td>代数转换</td><td>令 $x=a+\sqrt b,\quad y=a-\sqrt b$<br>则 $(a+\sqrt b)^n +(a-\sqrt b)^n=\;$<mark>$x^n+y^n=(x+y)(x^{n-1}+y^{n-1})-xy(x^{n-2}+y^{n-2})$</mark></td>
</tr>
<tr>
<td>构造递推函数</td><td>令 $g(n)=x^n+y^n\quad x+y=2a\quad xy=a^2-b$ <br /> $\therefore\;$ <span style="color:red;"> $g(n)=2a\times g(n-1)-(a^2-b^2)\times g(n-2),\quad g(1)=2a,\quad g(0)=2$ </span></td>
</tr>
<table>


# <font size="6px" id="qst2"><b>试证明 $\prod\limits_{x=1}^{n-1}([gcd(x,n)=1]\times x)\% n=1$</b></font>

|Thoughts|Solution|
| --- | --- |
|问题转化|求证小n且与n互质的数的乘积模 $n$ 一定为 $1$ 或 $-1$|
|因为是乘积，又与1有关，所以想<mark>逆元</mark>|在 $x^2\not\equiv1(mod\;n)$ 时<br><mark>$x\neq inv(x)$</mark>，$\therefore\;x$ 与 $inv(x)$ 在数组中<mark>成对出现</mark>且乘积贡献为1<br />|
|特殊情况处理|在 $x^2\equiv1(mod\; n)$ 时<br><mark>$x=inv(x)$</mark><br>但同时 $(n-x)^2=n^2-nx+x^2\equiv x^2\equiv1(mod\;n)$<br />$\therefore$<mark>$\;n-x=inv(n-x)$</mark><br />在此时 $x$ 与 $n-x$ 也独立成对出现，乘积贡献为<span style="color: grey">$\boxed{x(n-x)=nx-x^2\equiv -1(mod\;n)}$</span>-1|
|得出结论|<span style="color: red;">在小于n且与n互质的数中，会产生若干对数<br>它们的乘积要么是1要么是-1<br />所以累乘是1或-1|


# <font size="6px" id="qst3"><b>对方程 $f(k)=\sum\limits_{i_1=L}^H\sum\limits_{i_2=L}^H...\sum\limits_{i_n=L}^H[gcd(i_1,i_2,...,i_n)=k]$ 化简时间复杂度</b></font>

|Thoughts|Solution|
| --- | ---|
|构建基础方程式|由变换式 $F(k)=\sum\limits_{k\mid d}f(d)\Rightarrow f(k)=\sum\limits_{k\mid d}\mu(\frac dk)F(d)$<br />构建 $F(k)=\sum\limits_{i_1'=L}^H\sum\limits_{i_2'=L}^H...\sum\limits_{i_n'=L}^H[k\mid gcd(i_1,i_2,...,i_n)]$|
|化简 $F(x)$|不去枚举不必要枚举的数，令<span style="color:blue;"> $i'=\frac ik$ </span>，即<mark>枚举倍数</mark><br />$\therefore F(k)=\sum\limits_{i_1'=\frac {L-1}k}^{\frac Hk}\sum\limits_{i_2'=\frac {L-1}k}^{\frac Hk}...\sum\limits_{i_n'=\frac {L-1}k}^{\frac Hk}1=(\left\lfloor \frac Hk\right\rfloor-\left\lfloor\frac {L-1}k\right\rfloor)^n$ <br /><span style="color: red">L-1是前缀和思想，向前取一位</span>|
|<mark>根据反演式进行变换</mark>|由 $f(k)=\sum\limits_{k\mid d}\mu(\frac dk)F(d)$<br>我们在枚举d时同样要枚举倍数<br />$\therefore$ 令 <span style="color: blue;">$d'=\frac dk$</span>，同时令 <span style="color: blue;">$L'=\frac {L-1}k,\;H'=\frac Hk$</span><br>则此时 $f(k)=\sum\limits_{d'=1}^{H'}\mu(d')F(d'k)$|
|化简 $f(x)$|$F(d'k)=(\left\lfloor\frac{H}{d'k}\right\rfloor-\left\lfloor\frac{L-1}{d'k}\right\rfloor)^n$<br />$f(k)=\sum\limits_{d'=1}^{H'}\mu(d')(\left\lfloor\frac{H'}{d}\right\rfloor-\left\lfloor\frac{L'}{d'}\right\rfloor)^n$|
