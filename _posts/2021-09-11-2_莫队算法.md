---
layout: post
title: Ëé´ÈòüÁÆóÊ≥ï
subtitle: Á¶ªÁ∫øÊìç‰ΩúÂïäÔºåÂÖà‰øùÂ≠òÂêéËæìÂá∫Ôºüü§î
categories: Êï∞ÊçÆÁªìÊûÑ
tags: [Êï∞ÊçÆÁªìÊûÑ]
---

<head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
	<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
	</style>
        <style>
		.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
	</style>
</head>
<body for="html-export">
      <div class="mume markdown-preview  ">
      <ul>
<li><a href="#%E6%99%AE%E9%80%9A%E8%8E%AB%E9%98%9F">&#x666E;&#x901A;&#x83AB;&#x961F;</a>
<ul>
<li><a href="#%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B">&#x95EE;&#x9898;&#x7C7B;&#x578B;</a></li>
<li><a href="#%E4%BD%9C%E7%94%A8">&#x4F5C;&#x7528;</a></li>
<li><a href="#%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5">&#x4F18;&#x5316;&#x7B56;&#x7565;</a>
<ul>
<li><a href="#%E5%8F%8C%E6%8C%87%E9%92%88">&#x53CC;&#x6307;&#x9488;</a></li>
<li><a href="#%E6%8E%92%E5%BA%8F%E5%88%86%E5%9D%97">&#x6392;&#x5E8F;&#x5206;&#x5757;</a></li>
</ul>
</li>
<li><a href="#%E7%AE%97%E6%B3%95%E6%9E%B6%E6%9E%84">&#x7B97;&#x6CD5;&#x67B6;&#x6784;</a></li>
</ul>
</li>
<li><a href="#%E5%B8%A6%E4%BF%AE%E8%8E%AB%E9%98%9F">&#x5E26;&#x4FEE;&#x83AB;&#x961F;</a>
<ul>
<li><a href="#%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B-1">&#x95EE;&#x9898;&#x7C7B;&#x578B;</a></li>
<li><a href="#%E6%8C%87%E9%92%88%E7%A7%BB%E5%8A%A8">&#x6307;&#x9488;&#x79FB;&#x52A8;</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C">&#x4FEE;&#x6539;&#x64CD;&#x4F5C;</a></li>
<li><a href="#%E6%8E%92%E5%BA%8F%E4%BC%98%E5%85%88%E7%BA%A7">&#x6392;&#x5E8F;&#x4F18;&#x5148;&#x7EA7;</a></li>
<li><a href="#%E6%80%9D%E6%83%B3%E6%80%BB%E7%BB%93">&#x601D;&#x60F3;&#x603B;&#x7ED3;</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E6%9E%B6%E6%9E%84-1">&#x7B97;&#x6CD5;&#x67B6;&#x6784;</a></li>
</ul>
</li>
<li><a href="#%E5%9B%9E%E6%BB%9A%E8%8E%AB%E9%98%9F">&#x56DE;&#x6EDA;&#x83AB;&#x961F;</a>
<ul>
<li><a href="#%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B-2">&#x95EE;&#x9898;&#x7C7B;&#x578B;</a></li>
<li><a href="#%E6%96%B0%E9%81%8D%E5%8E%86%E6%96%B9%E6%B3%95">&#x65B0;&#x904D;&#x5386;&#x65B9;&#x6CD5;</a></li>
<li><a href="#%E5%88%86%E7%B1%BB%E8%AE%A8%E8%AE%BA">&#x5206;&#x7C7B;&#x8BA8;&#x8BBA;</a></li>
<li><a href="#%E6%80%9D%E6%83%B3%E6%80%BB%E7%BB%93-1">&#x601D;&#x60F3;&#x603B;&#x7ED3;</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E6%9E%B6%E6%9E%84-2">&#x7B97;&#x6CD5;&#x67B6;&#x6784;</a></li>
</ul>
</li>
<li><a href="#%E6%A0%91%E4%B8%8A%E8%8E%AB%E9%98%9F">&#x6811;&#x4E0A;&#x83AB;&#x961F;</a>
<ul>
<li><a href="#%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B-3">&#x95EE;&#x9898;&#x7C7B;&#x578B;</a></li>
<li><a href="#%E6%AC%A7%E6%8B%89%E5%BA%8F%E5%88%97">&#x6B27;&#x62C9;&#x5E8F;&#x5217;</a>
<ul>
<li><a href="#%E6%9E%84%E9%80%A0%E6%96%B9%E5%BC%8F">&#x6784;&#x9020;&#x65B9;&#x5F0F;</a></li>
<li><a href="#%E6%80%A7%E8%B4%A8">&#x6027;&#x8D28;</a></li>
<li><a href="#%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F">&#x64CD;&#x4F5C;&#x65B9;&#x5F0F;</a></li>
</ul>
</li>
<li><a href="#%E5%88%86%E7%B1%BB%E8%AE%A8%E8%AE%BA-1">&#x5206;&#x7C7B;&#x8BA8;&#x8BBA;</a></li>
<li><a href="#%E6%8C%87%E9%92%88%E7%A7%BB%E5%8A%A8-1">&#x6307;&#x9488;&#x79FB;&#x52A8;</a></li>
<li><a href="#%E6%80%9D%E6%83%B3%E6%80%BB%E7%BB%93-2">&#x601D;&#x60F3;&#x603B;&#x7ED3;</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E6%9E%B6%E6%9E%84-3">&#x7B97;&#x6CD5;&#x67B6;&#x6784;</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8C%E6%AC%A1%E7%A6%BB%E7%BA%BF%E8%8E%AB%E9%98%9F">&#x4E8C;&#x6B21;&#x79BB;&#x7EBF;&#x83AB;&#x961F;</a>
<ul>
<li><a href="#%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B-4">&#x95EE;&#x9898;&#x7C7B;&#x578B;</a></li>
<li><a href="#%E9%81%8D%E5%8E%86%E5%88%86%E7%B1%BB">&#x904D;&#x5386;&#x5206;&#x7C7B;</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E6%A1%86%E6%9E%B6">&#x7B97;&#x6CD5;&#x6846;&#x67B6;</a></li>
</ul>
</li>
</ul>
<h2 class="mume-header" id="%E6%99%AE%E9%80%9A%E8%8E%AB%E9%98%9F">&#x666E;&#x901A;&#x83AB;&#x961F;</h2>

<h3 class="mume-header" id="%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B">&#x95EE;&#x9898;&#x7C7B;&#x578B;</h3>

<blockquote>
<p>&#x7ED9;&#x5B9A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>&#x4E2A;&#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#xFF0C;&#x6CA1;&#x6709;&#x4FEE;&#x6539;&#x64CD;&#x4F5C;&#xFF0C;&#x6BCF;&#x6B21;&#x67E5;&#x8BE2;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x6570;</p>
</blockquote>
<h3 class="mume-header" id="%E4%BD%9C%E7%94%A8">&#x4F5C;&#x7528;</h3>

<p>&#x53EF;&#x4EE5;&#x89E3;&#x51B3;<span style="color: red;">&#x533A;&#x95F4;&#x79BB;&#x7EBF;&#x95EE;&#x9898;</span>&#x7684;&#x79BB;&#x7EBF;&#x7B97;&#x6CD5;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x7EBF;&#x53EF;&#x80FD;&#x4F1A;T&#x6389;<br>
&#x65F6;&#x95F4;&#x4E3A; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlogn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> &#xFF0C;&#x4F46;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x51FA;&#x9898;&#x4EBA;&#x5361;&#x83AB;&#x961F;</p>
<h3 class="mume-header" id="%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5">&#x4F18;&#x5316;&#x7B56;&#x7565;</h3>

<h4 class="mume-header" id="%E5%8F%8C%E6%8C%87%E9%92%88">&#x53CC;&#x6307;&#x9488;</h4>

<blockquote>
<p>&#x7ED9;&#x4E2A;&#x6570;&#x5217;&#x6709;&#x82E5;&#x5E72;&#x6B21;&#x8BE2;&#x95EE; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>L</mi><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[L,R]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span></span></span></span> &#x7684;&#x533A;&#x95F4;&#x548C;&#xFF08;&#x5F3A;&#x5236;&#x83AB;&#x961F;&#xFF09;</p>
<p>&#x89E3;&#xFF1A;&#x5F00;&#x4E2A;&#x6570;&#x7EC4;</p>
<table>
<thead>
<tr>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7</mn></mrow><annotation encoding="application/x-tex">7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span></span></span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7</mn></mrow><annotation encoding="application/x-tex">7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span></td>
</tr>
</tbody>
</table>
<p>&#x82E5;&#x73B0;&#x5728;&#x77E5;&#x9053; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[2,5]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mclose">]</span></span></span></span> &#x533A;&#x95F4;&#x548C;&#x4E3A;18<br>
&#xA0;&#xA0;&#xA0;&#x6C42; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>6</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[2,6]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mclose">]</span></span></span></span> &#x7684;&#x533A;&#x95F4;&#x548C; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x21D2;</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x21D2;</span></span></span></span> &#x52A0;&#x4E0A;&#x7B2C;6&#x9879;&#x7684;&#x503C;<br>
&#xA0;&#xA0;&#xA0;&#x6C42; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[2,4]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mclose">]</span></span></span></span> &#x7684;&#x533A;&#x95F4;&#x548C; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x21D2;</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x21D2;</span></span></span></span> &#x5220;&#x6389;&#x7B2C;5&#x9879;&#x7684;&#x503C;</p>
</blockquote>
<p>&#x6734;&#x7D20;&#x6765;&#x770B;&#xFF0C;&#x5BF9;&#x4E8E;&#x533A;&#x95F4; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>L</mi><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[L, R]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span></span></span></span> :</p><ol><br>
<li>&#x52A0;&#x4E0A;&#x5DE6;&#x8FB9;&#x4E00;&#x683C;&#x8D21;&#x732E;: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>d</mi><mi>d</mi><mo stretchy="false">(</mo><mo>&#x2212;</mo><mo>&#x2212;</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">add(--l)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mopen">(</span><span class="mord">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span></li><br>
<li>&#x52A0;&#x4E0A;&#x53F3;&#x8FB9;&#x4E00;&#x683C;&#x8D21;&#x732E;: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>d</mi><mi>d</mi><mo stretchy="false">(</mo><mo>+</mo><mo>+</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">add(++r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mopen">(</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></li><br>
<li>&#x51CF;&#x53BB;&#x5DE6;&#x8FB9;&#x4E00;&#x683C;&#x8D21;&#x732E;: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>b</mi><mo stretchy="false">(</mo><mo>+</mo><mo>+</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">sub(++l)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span></li><br>
<li>&#x51CF;&#x53BB;&#x53F3;&#x8FB9;&#x4E00;&#x683C;&#x8D21;&#x732E;: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>b</mi><mo stretchy="false">(</mo><mo>&#x2212;</mo><mo>&#x2212;</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">sub(--r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></li><p></p>
</ol>
<h4 class="mume-header" id="%E6%8E%92%E5%BA%8F%E5%88%86%E5%9D%97">&#x6392;&#x5E8F;&#x5206;&#x5757;</h4>

<blockquote>
<p>&#x82E5;&#x8BE2;&#x95EE; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> &#x6B21;&#xFF0C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mtext>&#x2005;&#x200A;</mtext><mo stretchy="false">[</mo><mi>n</mi><mo>&#x2212;</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mtext>&#x2005;&#x200A;</mtext><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mtext>&#x2005;&#x200A;</mtext><mo stretchy="false">[</mo><mi>n</mi><mo>&#x2212;</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mtext>&#x2005;&#x200A;</mtext><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">[1,2],\;[n-1,n],\;[1,2],\;[n-1,n],\;[1,2].....</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">]</span><span class="mord">.....</span></span></span></span> &#xFF0C;&#x4E0A;&#x9762;&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x53D8;&#x6210;&#x4E86; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(mn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">mn</span><span class="mclose">)</span></span></span></span></p>
<p>&#x53EF;&#x4EE5;&#x6539;&#x6210; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mtext>&#x2005;&#x200A;</mtext><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mtext>&#x2005;&#x200A;</mtext><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mtext>&#x2005;&#x200A;</mtext><mo stretchy="false">[</mo><mi>n</mi><mo>&#x2212;</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mtext>&#x2005;&#x200A;</mtext><mo stretchy="false">[</mo><mi>n</mi><mo>&#x2212;</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo><mtext>&#x2005;&#x200A;</mtext><mo stretchy="false">[</mo><mi>n</mi><mo>&#x2212;</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">[1,2],\;[1,2],\;[1,2],\;[n-1,n],\;[n-1,n]\;[n-1,n]...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mord">...</span></span></span></span></p>
</blockquote>
<p>&#x8FD9;&#x6837;&#x5C06;&#x8DDD;&#x79BB;&#x8F83;&#x8FD1;&#x7684;&#x533A;&#x95F4;&#x653E;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x53D8;&#x6210; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></p>
<h3 class="mume-header" id="%E7%AE%97%E6%B3%95%E6%9E%B6%E6%9E%84">&#x7B97;&#x6CD5;&#x67B6;&#x6784;</h3>

<p>|--&#x5206;&#x5757;<br>
|--&#x8BB0;&#x5F55;&#x8BE2;&#x95EE;<br>
|--&#x6392;&#x5E8F;<br>
|--&#x904D;&#x5386;&#x8BE2;&#x95EE;<br>
|----&#x82E5;&#x5DE6;&#x8FB9;&#x77ED;&#xFF0C;&#x5DE6;&#x6307;&#x9488;&#x5411;&#x5DE6;&#x52A0;&#x4E00;&#x4E2A;&#x6570;<br>
|----&#x82E5;&#x53F3;&#x8FB9;&#x77ED;&#xFF0C;&#x53F3;&#x6307;&#x9488;&#x5411;&#x53F3;&#x52A0;&#x4E00;&#x4E2A;&#x6570;<br>
|----&#x82E5;&#x5DE6;&#x8FB9;&#x957F;&#xFF0C;&#x5DE6;&#x6307;&#x9488;&#x5411;&#x53F3;&#x51CF;&#x4E00;&#x4E2A;&#x6570;<br>
|----&#x82E5;&#x53F3;&#x8FB9;&#x957F;&#xFF0C;&#x53F3;&#x6307;&#x9488;&#x5411;&#x5DE6;&#x51CF;&#x4E00;&#x4E2A;&#x6570;<br>
|----&#x8BB0;&#x5F55;&#x7B54;&#x6848;&#x5B58;&#x5165;&#x65B0;&#x6570;&#x7EC4;<br>
|--&#x4EE5;&#x65B0;&#x6570;&#x7EC4;&#x987A;&#x5E8F;&#x8F93;&#x51FA;</p>
<blockquote>
<p><a href="https://vjudge.net/problem/%E9%BB%91%E6%9A%97%E7%88%86%E7%82%B8-1878">&#x9ED1;&#x6697;&#x7206;&#x70B8;-1878&#x300A;HH&#x7684;&#x9879;&#x94FE;&#x300B;</a></p>
</blockquote>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">1e4</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> pos<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> a<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> res<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> RES<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Q</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> id<span class="token punctuation">;</span>
<span class="token punctuation">}</span>q<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">ONLINE_JUDGE</span></span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">&quot;in.in&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">&quot;out.out&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
        <span class="token comment">// n m l r</span>
        <span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
        cin <span class="token operator">&gt;&gt;</span> n <span class="token operator">&gt;&gt;</span> m <span class="token operator">&gt;&gt;</span> l <span class="token operator">&gt;&gt;</span> r<span class="token punctuation">;</span>
        <span class="token comment">// &#x5206;&#x5757;</span>
        <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
                cin <span class="token operator">&gt;&gt;</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>
                pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">/</span> len<span class="token punctuation">;</span>
        <span class="token comment">// &#x8BE2;&#x95EE;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
                cin <span class="token operator">&gt;&gt;</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">&gt;&gt;</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">,</span>
                q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token comment">// &#x6392;&#x5E8F;</span>
        <span class="token function">sort</span> <span class="token punctuation">(</span>q<span class="token punctuation">,</span> q <span class="token operator">+</span> m<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>Q x<span class="token punctuation">,</span> Q y<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> pos<span class="token punctuation">[</span>x<span class="token punctuation">.</span>l<span class="token punctuation">]</span> <span class="token operator">==</span> pos<span class="token punctuation">[</span>y<span class="token punctuation">.</span>l<span class="token punctuation">]</span> <span class="token operator">?</span> x<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> y<span class="token punctuation">.</span>r <span class="token operator">:</span> pos<span class="token punctuation">[</span>x<span class="token punctuation">.</span>l<span class="token punctuation">]</span> <span class="token operator">&lt;</span> pos<span class="token punctuation">[</span>y<span class="token punctuation">.</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// &#x521D;&#x59CB;&#x5316;&#x4E3A;&#x5F00;&#x533A;&#x95F4;</span>
        <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// &#x5DE6;&#x8FB9;&#x592A;&#x77ED;&#x4E86;&#xFF0C;l&#x5411;&#x5DE6;&#x52A0;&#x4E00;&#x683C;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">&lt;</span> l <span class="token punctuation">)</span> <span class="token function">Add</span> <span class="token punctuation">(</span> <span class="token operator">--</span> l <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// &#x53F3;&#x8FB9;&#x592A;&#x77ED;&#x4E86;&#xFF0C;r&#x5411;&#x53F3;&#x52A0;&#x4E00;&#x683C;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">&gt;</span> r <span class="token punctuation">)</span> <span class="token function">Add</span> <span class="token punctuation">(</span> <span class="token operator">++</span> r <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// &#x5DE6;&#x8FB9;&#x592A;&#x957F;&#x4E86;&#xFF0C;l&#x5411;&#x53F3;&#x51CF;&#x4E00;&#x683C;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">&gt;</span> l <span class="token punctuation">)</span> <span class="token function">Sub</span> <span class="token punctuation">(</span> <span class="token operator">++</span> l <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// &#x53F3;&#x8FB9;&#x592A;&#x957F;&#x4E86;&#xFF0C;r&#x5411;&#x5DE6;&#x51CF;&#x4E00;&#x683C;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">&lt;</span> r <span class="token punctuation">)</span> <span class="token function">Sub</span> <span class="token punctuation">(</span> <span class="token operator">--</span> r <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// &#x8BB0;&#x5F55;&#x7B54;&#x6848;</span>
                res<span class="token punctuation">[</span>q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> RES<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
                cout <span class="token operator">&lt;&lt;</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</pre><h2 class="mume-header" id="%E5%B8%A6%E4%BF%AE%E8%8E%AB%E9%98%9F">&#x5E26;&#x4FEE;&#x83AB;&#x961F;</h2>

<h3 class="mume-header" id="%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B-1">&#x95EE;&#x9898;&#x7C7B;&#x578B;</h3>

<blockquote>
<p>&#x591A;&#x4E86;&#x4E2A;&#x4FEE;&#x6539;&#x7684;&#x7248;&#x672C;&#x95EE;&#x9898;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x65F6;&#x95F4;</p>
</blockquote>
<p>&#x90A3;&#x4E48;&#x53EF;&#x4EE5;<span style="color: red;">&#x52A0;&#x4E00;&#x7EF4;&#x8BB0;&#x5F55;&#x65F6;&#x95F4;&#x6233;</span><br>
&#x6BCF;&#x6B21;&#x67E5;&#x8BE2;&#x53EF;&#x4EE5;&#x786E;&#x5B9A;&#x4E00;&#x4E0B;&#x7248;&#x672C;&#xFF0C;&#x5373;&#x7B2C; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> &#x6B21;&#x4FEE;&#x6539;&#x4E4B;&#x540E;&#xFF0C;&#x7B2C;k+1&#x6B21;&#x4FEE;&#x6539;&#x4E4B;&#x524D;</p>
<h3 class="mume-header" id="%E6%8C%87%E9%92%88%E7%A7%BB%E5%8A%A8">&#x6307;&#x9488;&#x79FB;&#x52A8;</h3>

<p>&#x5728;&#x540C;&#x7248;&#x672C;&#x4E0B;&#x7684;&#x79FB;&#x52A8; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> &#x53EF;&#x4EE5;&#x662F;&#x666E;&#x901A;&#x83AB;&#x961F;<br>
&#x5728;<span style="color: red;">&#x8DF3;&#x7248;&#x672C;</span>&#x4E0B;&#x79FB;&#x52A8; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r, t]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mclose">]</span></span></span></span> &#x8981;<span style="color: red;">&#x8003;&#x8651;&#x4E24;&#x79CD;&#x60C5;&#x51B5;</span><br>
1.&#x4FEE;&#x6539;&#x7684;&#x6570;&#x5728;&#x533A;&#x95F4;&#x5916;&#xFF0C;&#x4E0D;&#x7528;&#x7406;&#x4F1A;<br>
2.&#x4FEE;&#x6539;&#x7684;&#x6570;&#x5728;&#x533A;&#x95F4;&#x5185;&#xFF0C;&#x8BA1;&#x6570;&#x51CF;&#x4E00;&#x4E0B;&#x4FEE;&#x6539;&#x524D;&#x7684;&#x6570;&#xFF0C;&#x518D;&#x52A0;&#x4E00;&#x4E0B;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x6570;</p>
<h3 class="mume-header" id="%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C">&#x4FEE;&#x6539;&#x64CD;&#x4F5C;</h3>

<p>&#x53EF;&#x4EE5;&#x628A;&#x4FEE;&#x6539;&#x64CD;&#x4F5C;&#x8BB0;&#x5F55;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x6BCF;&#x6B21;&#x4FEE;&#x6539;&#x7684;&#x6570;&#x7EC4;&#x5185;&#x5B58;&#x653E;&#x8FD9;&#x6B21;&#x4FEE;&#x6539;&#x7684;&#x662F;&#x4EC0;&#x4E48;&#x6570;<br>
&#x90A3;&#x4E48;&#x5728;&#x6307;&#x9488;&#x79FB;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5C06;&#x539F;&#x4F4D;&#x7F6E;&#x7684;&#x6570;&#x548C;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x6570;<span style="color:red;">&#x4EA4;&#x6362;&#x4E00;&#x4E0B;</span></p>
<h3 class="mume-header" id="%E6%8E%92%E5%BA%8F%E4%BC%98%E5%85%88%E7%BA%A7">&#x6392;&#x5E8F;&#x4F18;&#x5148;&#x7EA7;</h3>

<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> &#x6240;&#x5728;&#x5757;&#x7F16;&#x53F7;&#xFF0C; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> &#x6240;&#x5728;&#x5757;&#x7F16;&#x53F7;&#xFF0C; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> &#x987A;&#x7740;&#x9012;&#x589E;<br>
&#x5757;&#x957F;&#x4E3A; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mroot><mrow><mi>n</mi><mi>t</mi></mrow><mn>3</mn></mroot><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\sqrt[3]{nt})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.14254em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord sqrt"><span class="root"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.769268em;"><span style="top:-2.947048em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size6 size1 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.89254em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span><span style="top:-2.85254em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.14746000000000004em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<h3 class="mume-header" id="%E6%80%9D%E6%83%B3%E6%80%BB%E7%BB%93">&#x601D;&#x60F3;&#x603B;&#x7ED3;</h3>

<p>&#x5E26;&#x4FEE;&#x83AB;&#x961F;&#x591A;&#x4E86;&#x4E2A;<span style="color:red;">&#x65F6;&#x95F4;&#x6233;</span>&#x7684;&#x79FB;&#x52A8;<br>
&#x4E5F;&#x53EF;&#x4EE5;&#x88AB;&#x89C6;&#x4F5C;&#x7B2C;&#x4E09;&#x4E2A;&#x6307;&#x9488;<br>
&#x5176;&#x4E2D;&#x53EF;&#x4EE5;&#x505A;&#x4E5F;&#x662F;&#x5FC5;&#x505A;&#x7684;&#x4F18;&#x5316;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x518D;&#x4FEE;&#x6539;&#x7684;&#x7684;&#x65F6;&#x5019;&#x8BB0;&#x5F55;&#x64CD;&#x4F5C;&#x800C;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#xFF0C;&#x56E0;&#x4E3A;&#x65F6;&#x95F4;&#x6233;&#x6307;&#x9488;&#x53EF;&#x80FD;&#x4F1A;&#x6765;&#x56DE;&#x6298;&#x8FD4;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x77E5;&#x9053;&#x4E0B;&#x4E00;&#x6B65;&#x8981;&#x6539;&#x6210;&#x4EC0;&#x4E48;<br>
&#x5728;&#x79FB;&#x52A8;&#x65F6;&#x95F4;&#x6233;&#x65F6;&#xFF0C;&#x8D70;&#x8FC7;&#x67D0;&#x4E2A;&#x4FEE;&#x6539;&#x65F6;&#x53EA;&#x9700;&#x8981;&#x5C06;&#x4FEE;&#x6539;&#x7684;&#x503C;&#x548C;&#x539F;&#x59CB;&#x503C;&#x8C03;&#x6362;&#x4E00;&#x4E0B;<br>
&#x5982;&#x679C;&#x5728;&#x533A;&#x95F4;&#x5916;&#x4E5F;&#x8981;&#x4EA4;&#x6362;&#xFF0C;&#x56E0;&#x4E3A;&#x4E4B;&#x540E;&#x904D;&#x5386; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>L</mi><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[L,R]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span></span></span></span> &#x4E5F;&#x4F1A;&#x8D70;&#x8FC7;&#x53BB;</p>
<h3 class="mume-header" id="%E7%AE%97%E6%B3%95%E6%9E%B6%E6%9E%84-1">&#x7B97;&#x6CD5;&#x67B6;&#x6784;</h3>

<p>|--&#x8BB0;&#x5F55;&#x67E5;&#x8BE2;<br>
|--&#x8BB0;&#x5F55;&#x4FEE;&#x6539;<br>
|--&#x5BF9;&#x67E5;&#x8BE2;&#x6392;&#x5E8F;<br>
|--&#x4E09;&#x4E2A;&#x6307;&#x9488;<br>
|----&#x5DE6;&#x53F3;&#x6307;&#x9488;&#x5728;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x5185;&#x8DD1;&#x6765;&#x56FA;&#x5B9A; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>q</mi><mi mathvariant="normal">.</mi><mi>l</mi><mo separator="true">,</mo><mi>q</mi><mi mathvariant="normal">.</mi><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[q.l,q.r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> &#x533A;&#x95F4;<br>
|----&#x7248;&#x672C;&#x6307;&#x9488;&#x5728;&#x591A;&#x4E2A;&#x7248;&#x672C;&#x4E0A;&#x8DF3;<br>
|------&#x4EA4;&#x6362;&#x4FEE;&#x6539;&#x7684;&#x6570;&#x548C;&#x539F;&#x6570;<br>
|------&#x5224;&#x65AD;&#x8FD9;&#x4E2A;&#x7248;&#x672C;&#x4FEE;&#x6539;&#x662F;&#x5426;&#x5728;&#x5DE6;&#x53F3;&#x6307;&#x9488;&#x90A3;&#xFF0C;&#x770B;&#x770B;&#x9700;&#x4E0D;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x5F53;&#x524D;RES<br>
|--&#x5F55;&#x5165;&#x7B54;&#x6848;<br>
|--&#x8F93;&#x51FA;</p>
<blockquote>
<p><a href="https://www.luogu.com.cn/problem/P1903">&#x6D1B;&#x8C37;-P1903&#x300A;[&#x56FD;&#x5BB6;&#x96C6;&#x8BAD;&#x961F;]&#x6570;&#x989C;&#x8272; / &#x7EF4;&#x62A4;&#x961F;&#x5217;&#x300B;</a></p>
</blockquote>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">1e4</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">,</span> M <span class="token operator">=</span> <span class="token number">1e6</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> cnt<span class="token punctuation">[</span>M<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> pos<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> len<span class="token punctuation">;</span>
<span class="token keyword">int</span> nq<span class="token punctuation">,</span> nm<span class="token punctuation">,</span> RES<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Q</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> t<span class="token punctuation">,</span> id<span class="token punctuation">;</span>
<span class="token punctuation">}</span>qry<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">M</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>mdf<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">add</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	RES <span class="token operator">+=</span> <span class="token operator">!</span> cnt<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">sub</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	RES <span class="token operator">-=</span> <span class="token operator">!</span> <span class="token operator">--</span> cnt<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">char</span> op<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%s%d%d&quot;</span><span class="token punctuation">,</span> op<span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span> op<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&apos;Q&apos;</span> <span class="token punctuation">)</span> <span class="token operator">++</span> nq<span class="token punctuation">,</span> qry<span class="token punctuation">[</span>nq<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> nm<span class="token punctuation">,</span> nq <span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>                <span class="token operator">++</span> nm<span class="token punctuation">,</span> mdf<span class="token punctuation">[</span>nm<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> 
	len <span class="token operator">=</span> <span class="token function">cbrt</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>n <span class="token operator">*</span> nm<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> 
		pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">/</span> len<span class="token punctuation">;</span>
	<span class="token function">sort</span> <span class="token punctuation">(</span> qry <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> qry <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> nm<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span> Q a<span class="token punctuation">,</span> Q b <span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span> pos<span class="token punctuation">[</span>a<span class="token punctuation">.</span>l<span class="token punctuation">]</span> <span class="token operator">!=</span> pos<span class="token punctuation">[</span>b<span class="token punctuation">.</span>l<span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> pos<span class="token punctuation">[</span>a<span class="token punctuation">.</span>l<span class="token punctuation">]</span> <span class="token operator">&lt;</span> pos<span class="token punctuation">[</span>b<span class="token punctuation">.</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span> pos<span class="token punctuation">[</span>a<span class="token punctuation">.</span>r<span class="token punctuation">]</span> <span class="token operator">!=</span> pos<span class="token punctuation">[</span>b<span class="token punctuation">.</span>r<span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> pos<span class="token punctuation">[</span>a<span class="token punctuation">.</span>r<span class="token punctuation">]</span> <span class="token operator">&lt;</span> pos<span class="token punctuation">[</span>b<span class="token punctuation">.</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span> pos<span class="token punctuation">[</span>a<span class="token punctuation">.</span>r<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>t <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>t<span class="token punctuation">;</span>
		<span class="token keyword">return</span> a<span class="token punctuation">.</span>t <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>t<span class="token punctuation">;</span>		
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> L <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> R <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> T <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> nq<span class="token punctuation">;</span> k <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span> L <span class="token operator">&lt;</span> qry<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token punctuation">)</span> <span class="token function">sub</span> <span class="token punctuation">(</span> a<span class="token punctuation">[</span>L <span class="token operator">++</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span> L <span class="token operator">&gt;</span> qry<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> a<span class="token punctuation">[</span><span class="token operator">--</span> L<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span> R <span class="token operator">&lt;</span> qry<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> a<span class="token punctuation">[</span><span class="token operator">++</span> R<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span> R <span class="token operator">&gt;</span> qry<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token punctuation">)</span> <span class="token function">sub</span> <span class="token punctuation">(</span> a<span class="token punctuation">[</span>R <span class="token operator">--</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span> T <span class="token operator">!=</span> qry<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>t <span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span> T <span class="token operator">&lt;</span> qry<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>t <span class="token punctuation">)</span> T <span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span> L <span class="token operator">&lt;=</span> mdf<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">&amp;&amp;</span> mdf<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">&lt;=</span> R <span class="token punctuation">)</span> 
				<span class="token function">sub</span> <span class="token punctuation">(</span> a<span class="token punctuation">[</span>mdf<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token function">add</span> <span class="token punctuation">(</span> mdf<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">swap</span> <span class="token punctuation">(</span> a<span class="token punctuation">[</span>mdf<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span> mdf<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span> T <span class="token operator">&gt;</span> qry<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>t <span class="token punctuation">)</span> T <span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		res<span class="token punctuation">[</span>qry<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> RES<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> nq<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> 
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\n&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><h2 class="mume-header" id="%E5%9B%9E%E6%BB%9A%E8%8E%AB%E9%98%9F">&#x56DE;&#x6EDA;&#x83AB;&#x961F;</h2>

<h3 class="mume-header" id="%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B-2">&#x95EE;&#x9898;&#x7C7B;&#x578B;</h3>

<blockquote>
<p>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x6570;&#x5217;&#xFF0C;&#x591A;&#x4E2A;&#x67E5;&#x8BE2;&#x533A;&#x95F4;&#x65B0;&#x5B9A;&#x4E49;&#x7684;&#x6700;&#x5927;&#x503C;<br>
&#x8FD9;&#x79CD;&#x597D;&#x589E;&#x52A0;<span style="color: red;">&#x4E0D;&#x597D;&#x5220;&#x9664;</span>&#x7684;&#x95EE;&#x9898;</p>
</blockquote>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;<span style="color: red;">&#x5168;&#x4F7F;&#x7528;&#x589E;&#x52A0;&#x64CD;&#x4F5C;</span>&#x6765;&#x8FDB;&#x884C;&#x8DD1;&#x6307;&#x9488;</p>
<h3 class="mume-header" id="%E6%96%B0%E9%81%8D%E5%8E%86%E6%96%B9%E6%B3%95">&#x65B0;&#x904D;&#x5386;&#x65B9;&#x6CD5;</h3>

<p>&#x6211;&#x4EEC;&#x5728;&#x56DE;&#x6EDA;&#x83AB;&#x961F;&#x4E2D;&#x4E00;&#x6B21;&#x8003;&#x8651;&#x4E00;&#x6574;&#x4E2A;&#x5757;&#x5176;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x8BE2;&#x95EE;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>&#x5728;&#x8BE5;&#x5757;&#x5185;&#x70B9;&#x8BE2;&#x95EE;<br>
&#x8FD9;&#x4E9B;&#x8BE2;&#x95EE;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>&#x9012;&#x589E;</p>
<h3 class="mume-header" id="%E5%88%86%E7%B1%BB%E8%AE%A8%E8%AE%BA">&#x5206;&#x7C7B;&#x8BA8;&#x8BBA;</h3>

<p>&#x8FD9;&#x6837;&#x904D;&#x5386;&#x65F6;&#x4F1A;&#x51FA;&#x73B0;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#xFF1A;<br>
1.&#x5F00;&#x59CB;&#x65F6;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>&#x548C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x5757;&#x5185;<br>
2.&#x540E;&#x9762;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>&#x548C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>&#x4E0D;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x5757;&#x5185;</p>
<p><strong>&#x60C5;&#x51B5;1&#xFF1A;</strong><br>
&#x7531;&#x4E8E;&#x4E00;&#x4E2A;&#x5757;&#x5185;&#x957F;&#x5EA6;&#x4E0D;&#x8D85;&#x8FC7; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>n</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.23972em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">n</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span></span></span></span> &#xFF0C;&#x6240;&#x4EE5;<span style="color: red;">&#x76F4;&#x63A5;&#x66B4;&#x529B;</span>&#x5373;&#x53EF;<br>
&#x4F46;&#x8FD9;&#x6CE2;&#x66B4;&#x529B;&#x662F;&#x6CA1;&#x6709;&#x6536;&#x76CA;&#x70B9;&#xFF0C;&#x53EA;&#x80FD;&#x7528;&#x6765;&#x8BB0;&#x4E00;&#x4E0B;&#x7B54;&#x6848;&#xFF0C;&#x904D;&#x5386;&#x5B8C;&#x8981;&#x6E05;&#x4E00;&#x4E0B; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span> &#x6570;&#x7EC4;<br>
<strong>&#x60C5;&#x51B5;2&#xFF1A;</strong><br>
&#x6211;&#x4EEC;&#x5C06;&#x67E5;&#x8BE2;&#x7684;&#x533A;&#x95F4;<span style="color:red;">&#x5206;&#x4E3A;&#x4E24;&#x90E8;&#x5206;</span><br>
1.&#x5728;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>&#x6240;&#x5728;&#x7684;&#x5757;&#x5185;<br>
&#x5BF9;&#x4E8E;&#x8FD9;&#x90E8;&#x5206;&#x540C;&#x6837;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x66B4;&#x529B;&#x89E3;&#x51B3;&#xFF0C;&#x7ED3;&#x675F;&#x4E86;&#x4E5F;&#x8981;&#x6E05;&#x4E00;&#x4E0B;&#x6570;&#x7EC4;<br>
2.&#x4E0D;&#x5728;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>&#x6240;&#x5728;&#x7684;&#x5757;&#x5185;<br>
&#x8FD9;&#x6837;&#x7684;&#x6240;&#x6709;&#x533A;&#x95F4;&#x5DE6;&#x7AEF;&#x70B9;&#x90FD;&#x56FA;&#x5B9A;&#x5728;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x5757;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;<br>
&#x8FD9;&#x4E9B;&#x533A;&#x95F4;&#x904D;&#x5386;&#x65F6;&#x53EA;&#x524D;&#x8FDB;&#x53F3;&#x7AEF;&#x70B9;<br>
&#x6211;&#x4EEC;&#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x53EA;&#x4F7F;&#x7528;&#x83AB;&#x961F;&#x7684; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">add</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span></span></span></span> &#x64CD;&#x4F5C;&#x6765;&#x5B9E;&#x73B0;</p>
<h3 class="mume-header" id="%E6%80%9D%E6%83%B3%E6%80%BB%E7%BB%93-1">&#x601D;&#x60F3;&#x603B;&#x7ED3;</h3>

<p>&#x65E2;&#x7136;&#x4F7F;&#x7528;&#x5220;&#x9664;&#x64CD;&#x4F5C;&#x5F88;&#x9EBB;&#x70E6;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x4F7F;&#x7528;&#x5220;&#x9664;&#x64CD;&#x4F5C;<br>
&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x77ED;&#x5230;&#x4E00;&#x4E2A;&#x5757;&#x5185;&#x7684;&#x533A;&#x95F4;&#xFF0C;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x66B4;&#x529B;&#x6C42;&#x89E3;<br>
&#x5BF9;&#x4E8E;&#x8DE8;&#x533A;&#x95F4;&#x7684;&#x5757;&#xFF0C;&#x5C06;&#x5176;&#x6309;&#x5DE6;&#x7AEF;&#x70B9;&#x5757;&#x7F16;&#x53F7;&#x5206;&#x7C7B;&#x4E4B;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x540C;&#x4E00;&#x7C7B;&#x7684;&#x6BCF;&#x4E2A;&#x533A;&#x95F4;&#x5206;&#x4E3A;&#x5DE6;&#x8FB9;&#x7684;&#x4E0D;&#x5230; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>n</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.23972em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">n</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span></span></span></span> &#x7684;&#x5C0F;&#x533A;&#x95F4;&#x548C;&#x53F3;&#x8FB9;&#x4E0D;&#x65AD;&#x524D;&#x8FDB;&#x7684;&#x5927;&#x533A;&#x95F4;&#xFF0C;&#x5DE6;&#x8FB9;&#x66B4;&#x529B;&#x53F3;&#x8FB9;&#x83AB;&#x961F;&#x5373;&#x53EF;&#x89E3;&#x51B3;&#x95EE;&#x9898;</p>
<h3 class="mume-header" id="%E7%AE%97%E6%B3%95%E6%9E%B6%E6%9E%84-2">&#x7B97;&#x6CD5;&#x67B6;&#x6784;</h3>

<p>|--&#x8BFB;&#x5165;&#x6570;&#x636E;&#x3001;&#x6392;&#x5E8F;&#x8BE2;&#x95EE;<br>
|--&#x904D;&#x5386;&#x8BE2;&#x95EE;<br>
|----&#x5F00;&#x59CB;&#x65F6; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">get(l)=get(r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span> &#xFF0C;&#x76F4;&#x63A5;&#x66B4;&#x529B;<br>
|----&#x540E;&#x9762;&#x65F6; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo><mo mathvariant="normal">&#x2260;</mo><mi>g</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">get(l)\neq get(r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel">&#xE020;</span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span><br>
|------&#x5BF9; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">get(l)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span> &#x5757;&#x4E0B;&#x7684;&#x90E8;&#x5206;&#x533A;&#x95F4;&#x8FDB;&#x884C;&#x66B4;&#x529B;<br>
|------&#x5BF9;&#x5176;&#x4F59;&#x90E8;&#x5206;&#x533A;&#x95F4;&#x8FDB;&#x884C;&#x83AB;&#x961F;&#x9012;&#x8FDB; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">add</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span></span></span></span><br>
|--&#x8F93;&#x51FA;&#x7B54;&#x6848;</p>
<blockquote>
<p><a href>&#x6D1B;&#x8C37;-P5906&#x300A;&#x3010;&#x6A21;&#x677F;&#x3011;&#x56DE;&#x6EDA;&#x83AB;&#x961F;&amp;&#x4E0D;&#x5220;&#x9664;&#x83AB;&#x961F;&#x300B;</a></p>
</blockquote>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> len<span class="token punctuation">;</span>
<span class="token keyword">int</span> w<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> cnt<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
ll res<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Q</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> id<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
<span class="token punctuation">}</span>q<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> nums<span class="token punctuation">;</span>

<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">get</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">/</span> len<span class="token punctuation">;</span><span class="token punctuation">}</span>

<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">add</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span> ll <span class="token operator">&amp;</span>RES <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cnt<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">++</span><span class="token punctuation">;</span>
        RES <span class="token operator">=</span> <span class="token function">max</span> <span class="token punctuation">(</span> RES<span class="token punctuation">,</span> <span class="token punctuation">(</span>ll<span class="token punctuation">)</span>cnt<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">*</span> nums<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">ONLINE_JUDGE</span></span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">&quot;in.in&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">&quot;out.out&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span> len <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> 
                <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                nums<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//&#x79BB;&#x6563;&#x5316;</span>
        <span class="token function">sort</span> <span class="token punctuation">(</span> nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        nums<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token function">unique</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> 
                w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">lower_bound</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        
        <span class="token comment">// &#x8BE2;&#x95EE;&#x8BFB;&#x5165;&#x4E0E;&#x6392;&#x5E8F;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>l<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
                q<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>i<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token function">sort</span> <span class="token punctuation">(</span> q<span class="token punctuation">,</span> q <span class="token operator">+</span> m<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span> Q a<span class="token punctuation">,</span> Q b <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token function">get</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">get</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> a<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// &#x904D;&#x5386;&#x8BE2;&#x95EE;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> y <span class="token operator">=</span> x<span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> y <span class="token operator">&lt;</span> m <span class="token operator">&amp;&amp;</span> <span class="token function">get</span><span class="token punctuation">(</span>q<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">get</span><span class="token punctuation">(</span>q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token punctuation">)</span> y <span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// [x,y-1]&#x7684;&#x533A;&#x95F4;&#x5185;&#x90FD;&#x662F;.l&#x76F8;&#x7B49;&#x7684;&#x67E5;&#x8BE2;</span>
                <span class="token keyword">int</span> right <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span>q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token operator">*</span> len <span class="token operator">+</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// q[x].l&#x6240;&#x5728;&#x7684;&#x5757;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x70B9;</span>

                <span class="token comment">// q[x].l&#x548C;q[x].r&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x5757;&#x5185;&#xFF0C;&#x76F4;&#x63A5;&#x66B4;&#x529B;&#x6C42;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> x <span class="token operator">&lt;</span> y <span class="token operator">&amp;&amp;</span> q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">&lt;=</span> right <span class="token punctuation">)</span> <span class="token punctuation">{</span> 
                        ll RES <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
                        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> k <span class="token operator">=</span> q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">;</span> k <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> w<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> RES <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        res<span class="token punctuation">[</span>q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> RES<span class="token punctuation">;</span>
                        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> k <span class="token operator">=</span> q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">;</span> k <span class="token operator">++</span> <span class="token punctuation">)</span> cnt<span class="token punctuation">[</span>w<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">// &#x56DE;&#x5230;&#x66F4;&#x65B0;&#x524D;&#x7684;&#x6570;&#x636E;&#x72B6;&#x6001;</span>
                        x <span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                
                <span class="token comment">// &#x6C42;&#x5728;&#x4E0D;&#x540C;&#x5757;&#x5185;&#x7684;&#x8BE2;&#x95EE;</span>
                ll RES <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> i <span class="token operator">=</span> right<span class="token punctuation">,</span> j <span class="token operator">=</span> right <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// &#x53F3;&#x7AEF;&#x70B9;&#x548C;&#x5DE6;&#x7AEF;&#x70B9;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> x <span class="token operator">&lt;</span> y <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> w<span class="token punctuation">[</span> <span class="token operator">++</span> i <span class="token punctuation">]</span><span class="token punctuation">,</span> RES <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x53F3;&#x7AEF;&#x70B9;&#x79FB;&#x52A8;&#x5230;&#x6B63;&#x786E;&#x7684;&#x4F4D;&#x7F6E;</span>
                        ll backup <span class="token operator">=</span> RES<span class="token punctuation">;</span> <span class="token comment">// &#x5907;&#x4EFD;&#x4E00;&#x4E0B;</span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span> j <span class="token operator">&gt;</span> q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> w<span class="token punctuation">[</span> <span class="token operator">--</span> j <span class="token punctuation">]</span><span class="token punctuation">,</span> RES <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5DE6;&#x7AEF;&#x70B9;&#x79FB;&#x52A8;&#x5230;&#x6B63;&#x786E;&#x7684;&#x4F4D;&#x7F6E;</span>
                        res<span class="token punctuation">[</span>q<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> RES<span class="token punctuation">;</span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span> j <span class="token operator">&lt;</span> right <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">)</span> cnt<span class="token punctuation">[</span>w<span class="token punctuation">[</span>j <span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">// &#x5DE6;&#x4FA7;&#x56DE;&#x5230;&#x66F4;&#x65B0;&#x524D;&#x7684;&#x6570;&#x636E;&#x72B6;&#x6001;&#xFF0C;&#x56E0;&#x4E3A;&#x5DE6;&#x4FA7;&#x4E0D;&#x5220;&#x8981;&#x91CD;&#x5F00;</span>
                        RES <span class="token operator">=</span> backup<span class="token punctuation">;</span> <span class="token comment">// &#x6062;&#x590D;&#x5907;&#x4EFD;</span>
                        x <span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token function">memset</span> <span class="token punctuation">(</span> cnt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> cnt <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x8FDB;&#x884C;&#x4E0B;&#x4E00;&#x90E8;&#x5206;&#x7684;&#x67E5;&#x8BE2;&#x524D;&#x8981;&#x6E05;&#x7A7A;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lld\n&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><h2 class="mume-header" id="%E6%A0%91%E4%B8%8A%E8%8E%AB%E9%98%9F">&#x6811;&#x4E0A;&#x83AB;&#x961F;</h2>

<h3 class="mume-header" id="%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B-3">&#x95EE;&#x9898;&#x7C7B;&#x578B;</h3>

<p>&#x7ED9;&#x4E00;&#x4E2A;&#x65E0;&#x6839;&#x666E;&#x901A;&#x6811;&#xFF0C;&#x82E5;&#x5E72;&#x8BE2;&#x95EE;&#xFF0C;&#x6811;&#x7684;&#x67D0;&#x6761;&#x8DEF;&#x5F84;&#x4E0A;&#x4E00;&#x5171;&#x6709;&#x591A;&#x5C11;&#x79CD;&#x4E0D;&#x540C;&#x6743;&#x91CD;</p>
<div class="mermaid">graph TB;
1((1)) --&gt; 2((2))
1((1)) --&gt; 3((3))
3((3)) --&gt; 5((5))
3((3)) --&gt; 6((6))
3((3)) --&gt; 7((7))
1((1)) --&gt; 4((4))
4((4)) --&gt; 8((8))
</div><p>&#x6743;&#x503C;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
</tr>
</thead>
<tbody>
<tr>
<td>45</td>
<td>2</td>
<td>9</td>
<td>1</td>
<td>8</td>
<td>5</td>
<td>7</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>&#x6811;&#x4E0A;&#x7684;&#x4FEE;&#x6539;&#x95EE;&#x9898;&#xFF0C;&#x53EF;&#x4EE5;&#x53D8;&#x6210;&#x4E00;&#x4E2A;&#x7EBF;&#x6027;&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x95EE;&#x9898;<br>
&#x5728;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6B27;&#x62C9;&#x5E8F;&#x5217;</p>
<h3 class="mume-header" id="%E6%AC%A7%E6%8B%89%E5%BA%8F%E5%88%97">&#x6B27;&#x62C9;&#x5E8F;&#x5217;</h3>

<h4 class="mume-header" id="%E6%9E%84%E9%80%A0%E6%96%B9%E5%BC%8F">&#x6784;&#x9020;&#x65B9;&#x5F0F;</h4>

<p><strong><span style="color: red;">&#x5BF9;&#x6811;DFS&#x4E00;&#x6B21;&#xFF0C;&#x6B63;&#x5E8F;&#x904D;&#x5386;&#x5230;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x65F6;&#x8BB0;&#x5F55;&#x4E00;&#x6B21;&#xFF0C;&#x540E;&#x5E8F;&#x904D;&#x5386;&#x518D;&#x8BB0;&#x5F55;&#x4E00;&#x6B21;</span></strong><br>
<span style="color:blue;">&#x6BD4;&#x5982;&#x4E0A;&#x9762;&#x7684;&#x6811;&#x53EF;&#x4EE5;&#x53D8;&#x4E3A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7</mn></mrow><annotation encoding="application/x-tex">7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7</mn></mrow><annotation encoding="application/x-tex">7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></p>
<h4 class="mume-header" id="%E6%80%A7%E8%B4%A8">&#x6027;&#x8D28;</h4>

<p>1.&#x6BCF;&#x4E2A;&#x70B9;&#x8FDB;&#x5165;&#x5199;&#x4E00;&#x6B21;&#xFF0C;&#x79BB;&#x5F00;&#x5199;&#x4E00;&#x6B21;&#xFF0C;&#x5171;&#x5199;&#x4E24;&#x6B21;<br>
2.&#x6BCF;&#x6B21;&#x8BE2;&#x95EE;&#x8DEF;&#x5F84; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>&#x2192;</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x\rightarrow y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> &#x9009;&#x5E8F;&#x5217;&#x4E2D;x&#x6700;&#x5F00;&#x59CB;(&#x6700;&#x540E;)&#x51FA;&#x73B0;&#x7684;&#x4F4D;&#x7F6E;&#x548C;y&#x6700;&#x5F00;&#x59CB;&#x51FA;&#x73B0;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x53EA;&#x4FDD;&#x7559;&#x4E2D;&#x95F4;&#x51FA;&#x73B0;&#x8FC7;&#x4E00;&#x6B21;&#x7684;&#x6570;</p>
<h4 class="mume-header" id="%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F">&#x64CD;&#x4F5C;&#x65B9;&#x5F0F;</h4>

<p>&#x4E24;&#x4E2A;&#x6570;&#x7EC4;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">first[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">rs</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> &#x8868;&#x793A; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span> &#x7B2C;&#x4E00;&#x6B21;&#x51FA;&#x73B0;&#x7684;&#x4F4D;&#x7F6E;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">last[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> &#x8868;&#x793A; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span> &#x7B2C;&#x4E8C;&#x6B21;&#x51FA;&#x73B0;&#x7684;&#x4F4D;&#x7F6E;<br>
&#x9009; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> &#x6EE1;&#x8DB3; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> &#x5728; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> &#x4E4B;&#x524D;&#x51FA;&#x73B0;&#xFF0C;&#x5373; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>&lt;</mo><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">first[x]\lt first[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">rs</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">rs</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span></p>
<h3 class="mume-header" id="%E5%88%86%E7%B1%BB%E8%AE%A8%E8%AE%BA-1">&#x5206;&#x7C7B;&#x8BA8;&#x8BBA;</h3>

<ol>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">lca(x,y)=x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> &#xFF0C;&#x5219;&#x6B27;&#x62C9;&#x5E8F;&#x5217;&#x4E2D; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>&#x2192;</mo><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">first[x]\rightarrow first[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">rs</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">rs</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span> &#x4E2D;&#x95F4;&#x53EA;&#x51FA;&#x73B0;&#x4E00;&#x6B21;&#x7684;&#x70B9;&#x5BF9;&#x5E94; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>&#x2192;</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x\rightarrow y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> &#x7684;&#x8DEF;&#x5F84;<span style="color: blue">&#xFF08;&#x56E0;&#x4E3A;&#x82E5;&#x51FA;&#x73B0;0&#x6B21;&#x8BF4;&#x660E;&#x6CA1;&#x641C;&#x5230;&#xFF0C;&#x82E5;&#x51FA;&#x73B0;&#x4E24;&#x6B21;&#x8BF4;&#x660E;&#x8FDB;&#x53BB;&#x641C;&#x4E86;&#x4F46;&#x662F;&#x4E0D;&#x5B58;&#x5728;</span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo mathvariant="normal">&#x2260;</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">lca(x,y)\neq x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel">&#xE020;</span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> &#xFF0C;&#x5219;&#x8DEF;&#x5F84;&#x5BF9;&#x5E94;&#x6B27;&#x62C9;&#x5E8F;&#x5217;&#x4E2D; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>&#x2192;</mo><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">last[x]\rightarrow first[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">rs</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span> &#x4E2D;&#x53EA;&#x51FA;&#x73B0;&#x4E00;&#x6B21;&#x7684;&#x70B9;&#x4EE5;&#x53CA; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">lca(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> <span style="color: blue;">&#xFF08;&#x56E0;&#x4E3A;&#x6700;&#x540E;&#x7684;lca&#x4ECD;&#x672A;&#x56DE;&#x6EAF;</span></li>
</ol>
<h3 class="mume-header" id="%E6%8C%87%E9%92%88%E7%A7%BB%E5%8A%A8-1">&#x6307;&#x9488;&#x79FB;&#x52A8;</h3>

<p>&#x4E09;&#x4E2A;&#x6570;&#x7EC4;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span> &#x8BB0;&#x5F55;&#x6743;&#x503C;&#x51FA;&#x73B0;&#x7684;&#x4E2A;&#x6570;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">st[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span> &#x8BB0;&#x5F55;&#x5E8F;&#x53F7;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;(0/1)&#xFF0C;<span style="color: red;">&#x66F4;&#x65B0;&#xFF1A; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><msup><mo stretchy="false">]</mo><mo>=</mo></msup><mn>1</mn></mrow><annotation encoding="application/x-tex">st[]^=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6198089999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mrel mtight">=</span></span></span></span></span></span></span></span><span class="mord">1</span></span></span></span> </span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">res</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">res</span></span></span></span> &#x5B9E;&#x65F6;&#x8BB0;&#x5F55;&#x7B54;&#x6848;</p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp"><span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">add</span> <span class="token punctuation">(</span> x <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        st<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> st<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span> res <span class="token operator">-=</span> <span class="token operator">!</span> <span class="token operator">--</span> cnt<span class="token punctuation">[</span>a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>              res <span class="token operator">-=</span> <span class="token operator">!</span> cnt<span class="token punctuation">[</span>a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">--</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>&#x7531;&#x4E8E;&#x51CF;&#x53BB;&#x4E00;&#x4E2A;&#x6570;&#x4E5F;&#x662F;&#x5F02;&#x6216;1&#xFF0C;&#x6240;&#x4EE5;&#x4E00;&#x4E2A; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">add</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span></span></span></span> &#x5C31;&#x591F;&#x7528;&#x4E86;</p>
<h3 class="mume-header" id="%E6%80%9D%E6%83%B3%E6%80%BB%E7%BB%93-2">&#x601D;&#x60F3;&#x603B;&#x7ED3;</h3>

<p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x6811;&#x4E0A;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x4E3B;&#x8981;&#x5229;&#x7528;&#x6B27;&#x62C9;&#x5E8F;&#x5217;&#x628A;&#x5B83;&#x53D8;&#x6210;&#x533A;&#x95F4;&#x95EE;&#x9898;<br>
&#x7136;&#x540E;&#x5BF9;&#x4E8E;&#x6B27;&#x62C9;&#x5E8F;&#x5217;&#x6027;&#x8D28;&#xFF08;&#x6709;&#x5173;lca&#xFF09;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F97;&#x51FA;&#x6211;&#x4EEC;&#x6BCF;&#x6B21;&#x8981;&#x56FA;&#x5B9A;&#x54EA;&#x4E2A;&#x533A;&#x95F4;&#x548C;&#x54EA;&#x4E9B;&#x6570;</p>
<h3 class="mume-header" id="%E7%AE%97%E6%B3%95%E6%9E%B6%E6%9E%84-3">&#x7B97;&#x6CD5;&#x67B6;&#x6784;</h3>

<p>|--&#x6C42;&#x6B27;&#x62C9;&#x5E8F;&#x5217;<br>
|--&#x6C42; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">lca</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span></span></span></span><br>
|----&#x9884;&#x5904;&#x7406; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f[][]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mclose">]</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span><br>
|----&#x500D;&#x589E;&#x5411;&#x4E0A;&#x8DF3;&#x627E; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">lca</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span></span></span></span><br>
|--&#x6811;&#x4E0A;&#x8BE2;&#x95EE; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> &#x5E8F;&#x5217;&#x8BE2;&#x95EE;<br>
|--&#x83AB;&#x961F;</p>
<blockquote>
<p><a href="https://www.acwing.com/problem/content/2536/">AcWing-2534 &#x300A;&#x6811;&#x4E0A;&#x8BA1;&#x6570;2&#x300B;</a></p>
</blockquote>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">100010</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> len<span class="token punctuation">;</span>
<span class="token keyword">int</span> w<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x8BFB;&#x5165;&#x70B9;&#x6743;</span>
<span class="token keyword">struct</span> <span class="token class-name">Edge</span> <span class="token punctuation">{</span> <span class="token keyword">int</span> nxt<span class="token punctuation">,</span> to<span class="token punctuation">;</span> <span class="token punctuation">}</span> edge<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">int</span> head<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> tot<span class="token punctuation">;</span> 
<span class="token keyword">int</span> depth<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x500D;&#x589E;lca&#x90A3;&#x4E00;&#x5957;</span>
<span class="token keyword">int</span> seq<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> top<span class="token punctuation">,</span> first<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> last<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x6B27;&#x62C9;&#x5E8F;&#x5217;&#xFF0C;&#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#x51FA;&#x73B0;&#x7684;&#x4E2A;&#x6570;&#xFF0C;&#x6700;&#x65E9;&#x51FA;&#x73B0;&#x7684;&#x4F4D;&#x7F6E;&#x548C;&#x6700;&#x540E;&#x51FA;&#x73B0;&#x7684;&#x4F4D;&#x7F6E;</span>
<span class="token keyword">int</span> cnt<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> st<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x6743;&#x503C;&#x4E0D;&#x540C;&#x4E2A;&#x6570;&#xFF0C;&#x5E8F;&#x53F7;&#x51FA;&#x73B0;&#x7684;&#x4E2A;&#x6570;&#xFF08;&#x5947;&#x6570;/&#x5076;&#x6570;&#xFF09;&#xFF0C;&#x7B54;&#x6848;&#x8BB0;&#x5F55;</span>
<span class="token keyword">int</span> que<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x5BBD;&#x641C;&#x961F;&#x5217;</span>
<span class="token keyword">struct</span> <span class="token class-name">Qry</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> id<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span> <span class="token comment">// &#x7B2C;id&#x4E2A;&#x67E5;&#x8BE2;&#xFF0C;&#x67E5;&#x8BE2;&#x533A;&#x95F4;&#x662F;l, r</span>
        <span class="token keyword">int</span> p<span class="token punctuation">;</span> <span class="token comment">// &#x6709;&#x65E0;&#x6700;&#x8FD1;&#x516C;&#x5171;&#x7956;&#x5148;</span>
<span class="token punctuation">}</span>q<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> nums<span class="token punctuation">;</span> <span class="token comment">// &#x79BB;&#x6563;&#x5316;</span>
<span class="token keyword">int</span> RES<span class="token punctuation">;</span> <span class="token comment">// &#x7B54;&#x6848;&#x5B9E;&#x65F6;&#x8BA1;&#x6570;</span>

<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">Add_Edge</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> from<span class="token punctuation">,</span> <span class="token keyword">int</span> to <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        edge<span class="token punctuation">[</span> <span class="token operator">++</span> tot <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>head<span class="token punctuation">[</span>from<span class="token punctuation">]</span><span class="token punctuation">,</span> to<span class="token punctuation">}</span><span class="token punctuation">;</span>
        head<span class="token punctuation">[</span>from<span class="token punctuation">]</span> <span class="token operator">=</span> tot<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// -----------------------------------------------------------------&#x6C42;&#x6B27;&#x62C9;&#x5E8F;&#x5217;</span>
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">dfs</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> father <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        seq<span class="token punctuation">[</span> <span class="token operator">++</span> top <span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">;</span>
        first<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> top<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">~</span>i<span class="token punctuation">;</span> i <span class="token operator">=</span> edge<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> j <span class="token operator">=</span> edge<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>to<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> j <span class="token operator">!=</span> father <span class="token punctuation">)</span> <span class="token function">dfs</span> <span class="token punctuation">(</span> j<span class="token punctuation">,</span> u <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
        seq<span class="token punctuation">[</span> <span class="token operator">++</span> top <span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">;</span>
        last<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> top<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ---------------------------------------------------------------------------</span>

<span class="token comment">// -------------------------------------------------------------------&#x9884;&#x5904;&#x7406;&#x500D;&#x589E;lca</span>
<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">lca</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> depth<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">&lt;</span> depth<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token function">swap</span> <span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span> k <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">--</span> <span class="token punctuation">)</span> 
                <span class="token keyword">if</span> <span class="token punctuation">(</span> depth<span class="token punctuation">[</span>f<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> depth<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token punctuation">)</span> 
                        a <span class="token operator">=</span> f<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> a <span class="token operator">==</span> b <span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span> k <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">--</span> <span class="token punctuation">)</span> 
                <span class="token keyword">if</span> <span class="token punctuation">(</span> f<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">!=</span> f<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token punctuation">)</span> 
                        a <span class="token operator">=</span> f<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>
                        b <span class="token operator">=</span> f<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> f<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">bfs</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">memset</span> <span class="token punctuation">(</span> depth<span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> depth <span class="token punctuation">)</span><span class="token punctuation">;</span>
        depth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> depth<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> hh <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> tt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        que<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span> hh <span class="token operator">&lt;=</span> tt <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> t <span class="token operator">=</span> que<span class="token punctuation">[</span>hh <span class="token operator">++</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> head<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">~</span>i<span class="token punctuation">;</span> i <span class="token operator">=</span> edge<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">int</span> to <span class="token operator">=</span> edge<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>to<span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span> depth<span class="token punctuation">[</span>to<span class="token punctuation">]</span> <span class="token operator">&gt;</span> depth<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                depth<span class="token punctuation">[</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> depth<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                                f<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
                                <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> <span class="token number">15</span><span class="token punctuation">;</span> k <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                        f<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> f<span class="token punctuation">[</span>f<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                                que<span class="token punctuation">[</span> <span class="token operator">++</span> tt <span class="token punctuation">]</span> <span class="token operator">=</span> to<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// ------------------------------------------------------------------------------------</span>

<span class="token comment">// ----------------------------------------------------------------------------- &#x83AB;&#x961F;&#x64CD;&#x4F5C;</span>
<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">get</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">/</span> len<span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">add</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        st<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> st<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cnt<span class="token punctuation">[</span>w<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>cnt<span class="token punctuation">[</span>w<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> RES <span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>cnt<span class="token punctuation">[</span>w<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> RES <span class="token operator">++</span><span class="token punctuation">;</span>
                cnt<span class="token punctuation">[</span>w<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// ------------------------------------------------------------------------------------</span>

<span class="token keyword">int</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">ONLINE_JUDGE</span></span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">&quot;in.in&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">&quot;out.out&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
        <span class="token comment">// &#x8BFB;&#x5165;&#x6570;&#x636E;&#x5E76;&#x8FDB;&#x884C;&#x79BB;&#x6563;&#x5316;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> 
                <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                nums<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sort</span> <span class="token punctuation">(</span> nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        nums<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token function">unique</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">lower_bound</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// &#x5EFA;&#x56FE;</span>
        <span class="token function">memset</span><span class="token punctuation">(</span>head<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> head<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> a<span class="token punctuation">,</span> b<span class="token punctuation">;</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">Add_Edge</span> <span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">Add_Edge</span> <span class="token punctuation">(</span> b<span class="token punctuation">,</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// &#x6C42;&#x6B27;&#x62C9;&#x5E8F;&#x5217;</span>
        <span class="token function">dfs</span> <span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// &#x9884;&#x5904;&#x7406;&#x6700;&#x8FD1;&#x516C;&#x5171;&#x7956;&#x5148;</span>
        <span class="token function">bfs</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// &#x8BE2;&#x95EE;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> a<span class="token punctuation">,</span> b<span class="token punctuation">;</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> 
                <span class="token comment">// &#x8F6C;&#x79FB;&#x6210;&#x7EBF;&#x6027;&#x533A;&#x95F4;&#x95EE;&#x9898;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> first<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">&gt;</span> first<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token function">swap</span> <span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> p <span class="token operator">=</span> <span class="token function">lca</span> <span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> a <span class="token operator">==</span> p <span class="token punctuation">)</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>i<span class="token punctuation">,</span> first<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span> first<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>i<span class="token punctuation">,</span> last<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span> first<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// &#x5206;&#x5757;&#x6392;&#x5E8F;</span>
        len <span class="token operator">=</span> <span class="token function">sqrt</span> <span class="token punctuation">(</span> top <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sort</span> <span class="token punctuation">(</span> q<span class="token punctuation">,</span> q <span class="token operator">+</span> m<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span> Qry a<span class="token punctuation">,</span> Qry b <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token function">get</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">get</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
                <span class="token keyword">else</span>                <span class="token keyword">return</span> a<span class="token punctuation">.</span>r <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// &#x83AB;&#x961F;&#x6307;&#x9488;&#x64CD;&#x4F5C;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> L <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> R <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> id <span class="token operator">=</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> l <span class="token operator">=</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">,</span> r <span class="token operator">=</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">,</span> p <span class="token operator">=</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>p<span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> R <span class="token operator">&lt;</span> r <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> seq<span class="token punctuation">[</span> <span class="token operator">++</span> R <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> R <span class="token operator">&gt;</span> r <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> seq<span class="token punctuation">[</span> R <span class="token operator">--</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> L <span class="token operator">&lt;</span> l <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> seq<span class="token punctuation">[</span> L <span class="token operator">++</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> L <span class="token operator">&gt;</span> l <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> seq<span class="token punctuation">[</span> <span class="token operator">--</span> L <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> p <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> p <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5982;&#x679C;x&#x4E0D;&#x662F;y&#x7684;&#x516C;&#x5171;&#x7956;&#x5148;&#x7684;&#x8BDD;&#x8981;&#x5148;&#x52A0;&#x4E0A;&#x518D;&#x51CF;&#x53BB;</span>
                res<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> RES<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> p <span class="token punctuation">)</span> <span class="token function">add</span> <span class="token punctuation">(</span> p <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// &#x8F93;&#x51FA;&#x7B54;&#x6848;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> 
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\n&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><h2 class="mume-header" id="%E4%BA%8C%E6%AC%A1%E7%A6%BB%E7%BA%BF%E8%8E%AB%E9%98%9F">&#x4E8C;&#x6B21;&#x79BB;&#x7EBF;&#x83AB;&#x961F;</h2>

<h3 class="mume-header" id="%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B-4">&#x95EE;&#x9898;&#x7C7B;&#x578B;</h3>

<blockquote>
<p>&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x914D;&#x5BF9;&#x542B;&#x4E49;&#xFF1A;&#x4E24;&#x4E2A;&#x6570;&#x5F02;&#x6216;&#x540E;&#x4E8C;&#x8FDB;&#x5236;&#x8868;&#x793A;&#x6709;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>&#x4E2A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span><br>
&#x957F;&#x5EA6;&#x4E3A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>&#x7684;&#x5E8F;&#x5217;&#xFF0C;&#x4E00;&#x4E2A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>&#xFF0C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>&#x6B21;&#x8BE2;&#x95EE;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>&#x5185;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x6570;&#x5BF9;&#x914D;&#x5BF9;<br>
&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x6BCF;&#x6B21;&#x6307;&#x9488;&#x79FB;&#x52A8;&#x4E4B;&#x540E;&#x5BF9;&#x6570;&#x636E;&#x7684;&#x4FEE;&#x6539;&#x503C;&#x975E;&#x5E38;&#x96BE;&#x7B97;</p>
</blockquote>
<p>&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x53EF;&#x4EE5;&#x628A;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x63A8;&#x5BFC;&#x6210;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x4F7F;&#x7528;&#x83AB;&#x961F;&#x79BB;&#x7EBF;&#x76F4;&#x63A5;&#x7B97;&#x51FA;&#x540E;&#xFF0C;&#x5BF9;&#x53E6;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x518D;&#x62CE;&#x51FA;&#x6765;&#x79BB;&#x7EBF;&#x7B97;&#x4E00;&#x6B21;</p>
<h3 class="mume-header" id="%E9%81%8D%E5%8E%86%E5%88%86%E7%B1%BB">&#x904D;&#x5386;&#x5206;&#x7C7B;</h3>

<p>&#x5BF9;&#x4E8E;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>L</mi><mo separator="true">,</mo><mtext>&#x2005;&#x200A;</mtext><mi>R</mi><mo>&#x27F6;</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[L,\;R\longrightarrow r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x27F6;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span></p>
<p>&#x539F;&#x662F;&#x601D;&#x60F3;&#x662F;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>&#x5411;&#x540E;&#x79FB;&#x52A8;&#x5E76;&#x52A0;&#x5165;&#x4E00;&#x4E2A;&#x6570;&#xFF0C;&#x770B;<span style="color:red;">&#x52A0;&#x5165;&#x7684;&#x8FD9;&#x4E2A;&#x6570;&#x5BF9;&#x7B54;&#x6848;&#x4F1A;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x4EC0;&#x4E48;&#x4EF7;&#x503C;&#x6216;&#x5F71;&#x54CD;</span><br>
&#x5728;&#x8FD9;&#x91CC;&#x52A0;&#x5165;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>&#x65F6;&#xFF0C;&#x770B;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>&#x8FD9;&#x4E2A;&#x4F4D;&#x7F6E;&#x4E0A;&#x7684;&#x6570;&#x80FD;&#x548C;&#x539F;&#x533A;&#x95F4;&#x5185;&#x591A;&#x5C11;&#x4E2A;&#x5143;&#x7D20;<span style="color:red;">&#x4EA7;&#x751F;&#x914D;&#x5BF9;</span></p>
<p>&#x6211;&#x4EEC;&#x4EE4;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">S_R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#x8868;&#x793A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,R]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span></span></span></span>&#x4E2D;&#x591A;&#x5C11;&#x4E2A;&#x6570;&#x4E0E;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>&#x4F4D;&#x7F6E;&#x914D;&#x5BF9;&#xFF0C;&#x5219;&#x4E0A;&#x95EE;&#x9898;&#x7684;&#x6C42;&#x6CD5;&#x5C31;&#x662F;<b><span style="color:red;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>R</mi></msub><mo>&#x2212;</mo><msub><mi>S</mi><mrow><mi>L</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">S_R-S_{L-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></span></b></p>
<p>&#x8BBE;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#x8868;&#x793A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mtext>&#xA0;</mtext><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_1~w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace nobreak">&#xA0;</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#x4E2D;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x6570;&#x4E0E;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">w_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>&#x914D;&#x5BF9;&#xFF0C;&#x6240;&#x4EE5;&#x95EE;&#x9898;&#x5173;&#x952E;&#x6307;&#x5411;<span style="color: red;">&#x9884;&#x5904;&#x7406;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><br>
&#x8BBE;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#x8868;&#x793A;&#x524D;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>&#x4E2A;&#x6570;&#x4E2D;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x4E0E;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>&#x914D;&#x5BF9;&#xFF0C;&#x5219;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>=</mo><msub><mi>g</mi><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></msub></mrow><annotation encoding="application/x-tex">f_i=g_{w_{i+1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.722325em;vertical-align:-0.291765em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32808571428571426em;"><span style="top:-2.357em;margin-left:-0.02691em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.20252142857142857em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.291765em;"><span></span></span></span></span></span></span></span></span></span><br>
&#x5BF9;&#x4E8E;&#x6BCF;&#x6B21;&#x52A0;&#x5165;&#x4E00;&#x4E2A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#x6211;&#x4EEC;&#x8981;&#x5BFB;&#x627E;&#x54EA;&#x4E9B;&#x6570;&#x548C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>&#x914D;&#x5BF9;&#xFF0C;&#x8BA9;&#x4ED6;&#x4EEC;&#x7684;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>+</mo><mo>+</mo></mrow><annotation encoding="application/x-tex">g()++</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">+</span></span></span></span><br>
&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x5EFA;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x5B58;&#x653E;&#x6240;&#x6709;&#x5B58;&#x5728;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>&#x4E2A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>&#x7684;&#x6570;<br>
&#x8981;&#x627E;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>&#x2297;</mo><mi>x</mi><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&#x21D2;</mo><mi>x</mi><mo>=</mo><msub><mi>w</mi><mi>i</mi></msub><mo>&#x2297;</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i\otimes x=y_i\Rightarrow x=w_i\otimes y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2297;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x21D2;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2297;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#x904D;&#x5386;&#x6240;&#x6709;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#x5F97;&#x5230;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>&#x8981;&#x52A0;&#x7684;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x662F;&#x5BF9;<span style="color: red;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>&#x2297;</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msub><mo>+</mo><mo>+</mo></mrow><annotation encoding="application/x-tex">g_{w_i\otimes y_i}++</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.02691em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">&#x2297;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">+</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#x8FD9;&#x4E48;&#x6C42;&#xFF0C;&#x90A3;&#x4E48;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#x4E5F;&#x51FA;&#x6765;&#x4E86;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2234;</mo><mtable rowspacing="0.2500em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>S</mi><mi>R</mi></msub><mo>=</mo><msub><mi>f</mi><mi>R</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>S</mi><mrow><mi>L</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mtext>&#x79BB;&#x7EBF;&#x6C42;</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\therefore\begin{aligned}&amp;S_R=f_R\\ &amp;S_{L-1}&#x79BB;&#x7EBF;&#x6C42;\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69224em;vertical-align:0em;"></span><span class="mrel amsrm">&#x2234;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000000000000004em;vertical-align:-1.2500000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">&#x79BB;&#x7EBF;&#x6C42;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>&#x6211;&#x4EEC;&#x5728;&#x63A8;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>&#x2192;</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">R\rightarrow r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>&#x65F6;&#xFF0C;&#x6BCF;&#x4E2A;&#x6570;&#x52A0;&#x8FDB;&#x6765;&#x90FD;&#x6C42;&#x4E00;&#x6B21;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>L</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">S_{L-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><br>
&#x90A3;&#x4E48;&#x5C31;&#x662F;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>L</mi><mo>&#x2212;</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,L-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>&#x6BCF;&#x6B21;&#x90FD;&#x914D;&#x5BF9;&#x4E00;&#x4E0B;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>R</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[R+1,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>&#x7684;&#x6570;<br>
&#x53EF;&#x5C06;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#x62FF;&#x51FA;&#x6765;&#xFF0C;&#x6BCF;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;&#x67D0;&#x4E2A;&#x56FA;&#x5B9A;&#x524D;&#x7F00;&#x4E2D;&#xFF0C;&#x67D0;&#x4E2A;&#x533A;&#x95F4;&#x6BCF;&#x4E2A;&#x6570;&#x548C;&#x8FD9;&#x4E2A;&#x524D;&#x7F00;&#x4E2D;&#x591A;&#x5C11;&#x4E2A;&#x6570;&#x914D;&#x5BF9;<br>
&#x4ECE;&#x524D;&#x5F80;&#x540E;&#x6C42;&#x524D;&#x7F00;&#x5373;&#x524D;&#x7F00;&#x662F;1&#x7684;&#x54EA;&#x4E9B;&#x8BE2;&#x95EE;&#x53EF;&#x4EE5;&#x5E72;&#x6389;&#xFF0C;2&#x7684;&#x54EA;&#x4E9B;&#x8BE2;&#x95EE;&#x53EF;&#x4EE5;&#x5E72;&#x6389;&#xFF0C;3&#x7684;&#xFF0C;......<br>
&#x8FD9;&#x4E9B;&#x90FD;&#x53EF;&#x4EE5;&#x79BB;&#x7EBF;&#x505A;&#x4E00;&#x904D;&#x51FA;&#x6765;</p>
<p>&#x90A3;&#x4E48;&#x7B2C;&#x4E00;&#x6B21;&#x79BB;&#x7EBF;&#x5F97;&#x5230;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">S_R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#xFF0C;&#x518D;&#x79BB;&#x7EBF;&#x4E00;&#x6B21;&#x7EDF;&#x4E00;&#x51FA;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>L</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">S_{L-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><br>
<span style="color: red;">&#x6CE8;&#xFF1A;&#x6BCF;&#x6B21;&#x6C42;&#x7684;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>R</mi></msub><mo>&#x2212;</mo><msub><mi>S</mi><mrow><mi>L</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">S_R-S_{L-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>&#x662F;&#x589E;&#x91CF;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">add</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span></span></span></span>&#x7684;&#x6570;&#x503C;</span></p>
<blockquote>
<p>&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x7684;&#x5206;&#x7C7B;&#x8BA8;&#x8BBA;&#x60C5;&#x51B5;&#x4E5F;&#x540C;&#x7406;</p>
</blockquote>
<h3 class="mume-header" id="%E7%AE%97%E6%B3%95%E6%A1%86%E6%9E%B6">&#x7B97;&#x6CD5;&#x6846;&#x67B6;</h3>

<p>|--&#x95EE;&#x9898;&#x63A8;&#x5BFC;&#x8F6C;&#x5316;&#xFF0C;&#x505A;&#x4E00;&#x4E2A;&#x524D;&#x7F00;&#x548C;&#x5206;&#x6210;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#x53BB;&#x89E3;<br>
|--&#x8BFB;&#x5165;&#x6570;&#x636E;&#x8BFB;&#x5165;&#x8BE2;&#x95EE;&#x6392;&#x5E8F;<br>
|--&#x904D;&#x5386;<br>
|----&#x7B2C;&#x4E00;&#x6B21;&#x83AB;&#x961F;&#x904D;&#x5386;&#x6C42;&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x9898;<br>
|----&#x7B2C;&#x4E8C;&#x6B21;&#x987A;&#x5E8F;&#x904D;&#x5386;&#x6C42;&#x7B2C;&#x4E8C;&#x4E2A;&#x95EE;&#x9898;<br>
|--&#x5408;&#x5E76;&#x7B54;&#x6848;&#x8F93;&#x51FA;</p>
<blockquote>
<p><a href="https://www.luogu.com.cn/problem/P4887">&#x3010;&#x6A21;&#x677F;&#x3011;&#x83AB;&#x961F;&#x4E8C;&#x6B21;&#x79BB;&#x7EBF;&#xFF08;&#x7B2C;&#x5341;&#x56DB;&#x5206;&#x5757;(&#x524D;&#x4F53;)&#xFF09;</a></p>
</blockquote>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">100010</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> k<span class="token punctuation">,</span> len<span class="token punctuation">;</span>
<span class="token keyword">int</span> w<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
ll res<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Q</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> id<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
        ll RES<span class="token punctuation">;</span> <span class="token comment">// &#x5148;&#x5B58;&#x4E00;&#x4E0B;&#xFF0C;&#x5206;&#x6210;&#x4E24;&#x6B21;&#x6C42;&#x5F97;</span>
<span class="token punctuation">}</span> q<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Range</span> <span class="token punctuation">{</span> <span class="token comment">// &#x5F85;&#x89E3;&#x51B3;&#x95EE;&#x9898;</span>
        <span class="token keyword">int</span> id<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
        <span class="token keyword">int</span> t<span class="token punctuation">;</span> <span class="token comment">// &#x5224;&#x65AD;&#x8981;&#x52A0;&#x8FD8;&#x662F;&#x51CF;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span>Range<span class="token operator">&gt;</span> range<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x524D;&#x7F00;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x591A;&#x4E2A;&#x8BE2;&#x95EE;&#x533A;&#x95F4;</span>
<span class="token keyword">int</span> f<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> g<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x63A8;&#x7684;&#x516C;&#x5F0F;&#x5173;&#x7CFB;&#x7684;&#x9700;&#x8981;&#x7684;&#x6570;&#x7EC4;</span>

<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">get</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">/</span> len<span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">get_count</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// &#x6709;&#x591A;&#x5C11;&#x4E2A;1</span>
        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span> x <span class="token punctuation">)</span> res <span class="token operator">+=</span> x <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">,</span> x <span class="token operator">&gt;&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">ONLINE_JUDGE</span></span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">&quot;in.in&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">&quot;out.out&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d%d%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">,</span> <span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// &#x5B58;&#x653E;&#x6240;&#x6709;&#x6709;k&#x4E2A;1&#x7684;&#x6570;</span>
        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> nums<span class="token punctuation">;</span> 
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">14</span><span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">get_count</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> k <span class="token punctuation">)</span> 
                        nums<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// &#x521D;&#x59CB;&#x5316;fg&#x6570;&#x7EC4;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">auto</span> x <span class="token operator">:</span> nums <span class="token punctuation">)</span> g<span class="token punctuation">[</span>w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">]</span> <span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// &#x6C42;&#x5F53;&#x524D;&#x65B0;&#x52A0;&#x7684;&#x8FD9;&#x4E2A;&#x6570;&#xFF08;w[i]&#xFF09;&#x5BF9;&#x4E8E;&#x54EA;&#x4E9B;x&#x662F;&#x6709;&#x5F71;&#x54CD;&#x7684;</span>
                f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> g<span class="token punctuation">[</span>w<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x516C;&#x5F0F;&#x5173;&#x7CFB;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// &#x8BFB;&#x5165;&#x8BE2;&#x95EE;&#xFF0C;&#x6392;&#x5E8F;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span> cin <span class="token operator">&gt;&gt;</span> l <span class="token operator">&gt;&gt;</span> r<span class="token punctuation">;</span>
                q<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>i<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        len <span class="token operator">=</span> <span class="token function">sqrt</span> <span class="token punctuation">(</span> n <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sort</span> <span class="token punctuation">(</span> q<span class="token punctuation">,</span> q <span class="token operator">+</span> m<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span> Q a <span class="token punctuation">,</span>Q b <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token function">get</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">get</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> a<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// &#x83AB;&#x961F;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> L <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> R <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token comment">// S_R - S_{L - 1}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> R <span class="token operator">&lt;</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token punctuation">)</span> range<span class="token punctuation">[</span>L <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span>i<span class="token punctuation">,</span> R <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [R + 1, r] &#x5148;&#x4E0D;&#x5904;&#x7406;&#xFF0C;&#x52A0;&#x5165;&#x8BE2;&#x95EE;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> R <span class="token operator">&lt;</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token punctuation">)</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>RES <span class="token operator">+=</span> f<span class="token punctuation">[</span> R <span class="token operator">++</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// - ( S_{R - 1} - S_{L - 1} )</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> R <span class="token operator">&gt;</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token punctuation">)</span> range<span class="token punctuation">[</span>L <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span>i<span class="token punctuation">,</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> R<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [r + 1, R] &#x5148;&#x4E0D;&#x5904;&#x7406;&#xFF0C; &#x52A0;&#x5165;&#x8BE2;&#x95EE;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> R <span class="token operator">&gt;</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token punctuation">)</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>RES <span class="token operator">-=</span> f<span class="token punctuation">[</span> <span class="token operator">--</span> R <span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// - ( S_R - S_L )</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> L <span class="token operator">&lt;</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token punctuation">)</span> range<span class="token punctuation">[</span>R<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span>i<span class="token punctuation">,</span> L<span class="token punctuation">,</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [L, l - 1] &#x5148;&#x4E0D;&#x5904;&#x7406;&#xFF0C; &#x52A0;&#x5165;&#x8BE2;&#x95EE;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> L <span class="token operator">&lt;</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token punctuation">)</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>RES <span class="token operator">+=</span> f<span class="token punctuation">[</span>L <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">!</span>k<span class="token punctuation">,</span> L <span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// &#x56E0;&#x4E3A;&#x5B58;&#x7684;&#x662F;[1, L - 1]&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x4E0E;L&#x914D;&#x5BF9;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x591A;&#x52A0;&#x4E2A;&#x5224;&#x65AD;w_L&#x662F;&#x5426;&#x914D;&#x5BF9;(k!=0)</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span> L <span class="token operator">&gt;</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token punctuation">)</span> range<span class="token punctuation">[</span>R<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span>i<span class="token punctuation">,</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">,</span> L <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [l, L - 1] &#x5148;&#x4E0D;&#x5904;&#x7406;&#xFF0C; &#x52A0;&#x5165;&#x8BE2;&#x95EE;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span> L <span class="token operator">&gt;</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token punctuation">)</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>RES <span class="token operator">-=</span> f<span class="token punctuation">[</span>L <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">!</span>k<span class="token punctuation">,</span> L <span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// &#x6574;&#x4F53;&#x6C42;&#x4E00;&#x4E0B;&#x6CA1;&#x6C42;&#x7684;&#x90E8;&#x5206;</span>
        <span class="token function">memset</span> <span class="token punctuation">(</span> g<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> g <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// &#x679A;&#x4E3E;&#x6BCF;&#x4E2A;&#x524D;&#x7F00;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">auto</span> x <span class="token operator">:</span> nums <span class="token punctuation">)</span> g<span class="token punctuation">[</span>w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">]</span> <span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// &#x679A;&#x4E3E;&#x6240;&#x6709;&#x6EE1;&#x8DB3;&#x8981;&#x6C42;&#x7684;y</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> rg <span class="token operator">:</span> range<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token operator">=</span> rg<span class="token punctuation">.</span>l<span class="token punctuation">;</span> x <span class="token operator">&lt;=</span> rg<span class="token punctuation">.</span>r<span class="token punctuation">;</span> x <span class="token operator">++</span> <span class="token punctuation">)</span>
                                q<span class="token punctuation">[</span>rg<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>RES <span class="token operator">+=</span> g<span class="token punctuation">[</span>w<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">*</span> rg<span class="token punctuation">.</span>t<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// &#x56E0;&#x4E3A;&#x6BCF;&#x6B21;&#x6C42;&#x7684;&#x662F;&#x589E;&#x91CF;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x7D2F;&#x52A0;&#x524D;&#x7F00;&#x548C;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>RES <span class="token operator">+=</span> q<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>RES<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> res<span class="token punctuation">[</span>q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>RES<span class="token punctuation">;</span>


        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lld\n&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
      </div>
      
      
    
    
    <script>
// config mermaid init call
// http://knsv.github.io/mermaid/#configuration
//
// You can edit the 'MERMAID_CONFIG' variable below.
MERMAID_CONFIG = {
  startOnLoad: false
}

if (window['MERMAID_CONFIG']) {
  window['MERMAID_CONFIG'].startOnLoad = false
  window['MERMAID_CONFIG'].cloneCssStyles = false
  window['MERMAID_CONFIG'].theme = "default"
}
mermaid.initialize(window['MERMAID_CONFIG'] || {})
if (typeof(window['Reveal']) !== 'undefined') {
  function mermaidRevealHelper(event) {
    var currentSlide = event.currentSlide
    var diagrams = currentSlide.querySelectorAll('.mermaid')
    for (var i = 0; i < diagrams.length; i++) {
      var diagram = diagrams[i]
      if (!diagram.hasAttribute('data-processed')) {
        mermaid.init(null, diagram, ()=> {
          Reveal.slide(event.indexh, event.indexv)
        })
      }
    }
  }
  Reveal.addEventListener('slidechanged', mermaidRevealHelper)
  Reveal.addEventListener('ready', mermaidRevealHelper)
} else {
  mermaid.init(null, document.getElementsByClassName('mermaid'))
}
</script></body>
