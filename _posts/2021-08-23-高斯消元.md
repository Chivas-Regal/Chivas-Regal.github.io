---
title: 高斯消元
subtitle: 好多好大的方程组啊，怎么解呢？🤔
categories: 数学
tags: [数学]
---

## 高斯消元的作用
高斯消元可以在 $n^3$ 的时间复杂度之内解一个 $$\left\{\begin{aligned}
&a_{11}x_1+a_{12}x_2+...+a_{1n}x_n=b_1\\
&a_{21}x_1+a_{22}x_2+...+a_{2n}x_n=b_2\\
&...\\
&a_{n1}x_1+a_{n2}x_2+...+a{nn}x_n=b_n
\end{aligned}\right.$$ 这样的<span style="color:red;">多元线性方程组</span>  
<mark>解可以有无解、无穷多解、唯一解</mark>  

## 初等行列变换

### 性质
将系数抽出成行列式
$$\begin{matrix}
&a_{11}&a_{12}&...&a_{1n}\\
&a_{21}&a_{22}&...&a_{2n}\\
&...\\
&a_{n1}&a_{n2}&...&a_{nn}
\end{matrix}$$  
下面这些变换是<span style="color: red;">等价变换</span>
<ol>
<li>把某一行乘上一个非零数</li>
<li>交换某两行</li>
<li>把某行若干倍加到另一行上去</li>
</ol>

### 目的
想变成 $$\left\{\begin{aligned}
&a_{11}x_{1}&+a_{12}x_2&+...&+a_{1n}x_n&=b_1\\
&&a_{22}x_2&+...&+a_{2n}x_n&=b_2\\
&&&\;\quad...\\
&&&&\;\quad x_n&=b_n
\end{aligned}\right.$$ 这样一个上三角方程组形式  
那么就<span style="color: red;">可以从最后一个已知的解一个个往上求得别的解</span>  

### 结果
1.完美的阶梯形：唯一解
2.不完美阶梯形： $\left\{\begin{aligned}
&0=非0：&无解\\
&0=0：&无穷解
\end{aligned}\right.$

## 例方程组与过程
$$\mathbf{Question:解方程\left\{\begin{aligned}
&x_1+2x_2-x_3=-6\\
&2x_1+x_2-3x_3=-9\\
&-x_1-x_2+2x_3=7
\end{aligned}\right.}$$   
抽出系数矩阵  $\begin{matrix}
        &1&2&-1&6\\
        &2&1&-3&-9\\
        &-1&-1&2&7
\end{matrix}$  
    
**高斯消元：**
<ul>
        <span style="color: blue;"><li>
        枚举每一列c
        <ol>
                <span style="color:brown;"><li>找到当前列绝对值最大一行</li></span>
                <span style="color:brown;"><li>将该行换到最上面</li></span>
                <span style="color:red;"><li>将该行第一个数变成1</li></span>
                <span style="color:yellowgreen;"><li>将下面所有行的当前列消为0</li></span>
        </ol>
        </li></span>
        <span style="color: blue;"><li>向上消元，将每一列只保留前面的1，后面的消为0</li></span>
<ul>
<hr style="border: 0;
    height: 1px;
    background: #333;
    background-image: linear-gradient(to right, #ccc, #333, #ccc);"> 
  
  
${\color{brown}\begin{matrix}
&2&1&-3&-9\\
&1&2&-1&6\\
&-1&-1&2&7
\end{matrix}}
\Rightarrow
{\color{red}\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&1&2&-1&-6\\
&-1&-1&2&7
\end{matrix}}
\stackrel{\color{yellowgreen}\begin{aligned}row_3+row_2\\row_2-row_1\end{aligned}}{\Rightarrow}
{\color{yellowgreen}\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&0&\frac32&\frac12&-\frac32\\
&0&-\frac12&\frac12&\frac52
\end{matrix}}$  

<hr style="border: 0;
    height: 1px;
    background: #333;
    background-image: linear-gradient(to right, #ccc, #333, #ccc);">  
    
${\color{brown}\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&0&\frac32&\frac12&-\frac32\\
&0&-\frac12&\frac12&\frac52
\end{matrix}}
\Rightarrow
{\color{red}\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&0&1&\frac13&-1\\
&0&-\frac12&\frac12&\frac52
\end{matrix}}
\stackrel{\color{yellowgreen}row_3+\frac{row_2}2}{\Rightarrow}
{\color{yellowgreen}\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&0&1&\frac13&-1\\
&0&0&\frac23&2
\end{matrix}}$  

<hr style="border: 0;
    height: 1px;
    background: #333;
    background-image: linear-gradient(to right, #ccc, #333, #ccc);">  
    
${\color{brown}\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&0&1&\frac13&-1\\
&0&0&\frac23&2
\end{matrix}}
\Rightarrow
{\color{red}\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&0&1&\frac13&-1\\
&0&0&1&3
\end{matrix}}$
  
<hr style="border: 0;
    height: 1px;
    background: #333;
    background-image: linear-gradient(to right, #ccc, #333, #ccc);">  
    
${\color{blue}\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&0&1&\frac13&-1\\
&0&0&1&3
\end{matrix}}
\stackrel{\color{blue}row_2-\frac{row_3}3}{\Rightarrow}
{\color{blue}\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&0&1&0&-2\\
&0&0&1&3
\end{matrix}}
\stackrel{\color{blue}row_1-\frac{row_2}3}{\Rightarrow}
{\color{blue}\begin{matrix}
&1&0&-\frac32&-\frac72\\
&0&1&0&-2\\
&0&0&1&3
\end{matrix}}
\stackrel{\color{blue}row_1-\frac{3*row_3}2}{\Rightarrow}
{\color{blue}\begin{matrix}
&1&0&0&1\\
&0&1&0&-2\\
&0&0&1&3
\end{matrix}}$  
  
解得方程： $(x_1,x_2,x_3)=(1,-2,3)$

## 程序实现

```cpp
const int N = 110;
const double eps = 1e-6; // 有较多比较，使用eps
int n;
double a[N][N];

inline int Gauss () { // 返回值：0唯一解，1无穷多解，2无解
        int c, r;
        for ( c = 0, r = 0; c < n; c ++ ) { // 一列一列向后枚举
                int t = r; // 维护当前列元素最大的是第几行
                for ( int i = r; i < n; i ++ ) 
                        if ( fabs(a[i][c]) > fabs(a[t][c]) ) t = i; // 维护
                if ( fabs(a[t][c]) < eps ) continue; // 如果最大的都是0的话，那么就跳过这一列
                for ( int i = c; i <= n; i ++ ) swap(a[t][i], a[r][i]); // 把第t行换到上面
                for ( int i = n; i >= c; i -- ) a[r][i] /= a[r][c]; // 把上面这一行的第一个数约成1
                for ( int i = r + 1; i < n; i ++ ) // 下面所有行的当前列消成0
                        if ( fabs(a[i][c]) > eps ) // 如果是0就不消了
                                for ( int j = n; j >= c; j -- ) a[i][j] -= a[r][j] * a[i][c]; // 这个方程的系数都要减
                r ++;
        }
        if ( r < n ) {
                for ( int i = r; i < n; i ++ ) 
                        if ( fabs(a[i][n]) > eps ) return 2; // 无解
                return 1; // 有无穷多组解
        } 

        for ( int i = n - 1; i >= 0; i -- ) 
                for ( int j = i + 1; j < n; j ++ ) 
                        a[i][n] -= a[i][j] * a[j][n]; // 只保留第一个1，后面的都消为0

        return 0; // 有唯一解
}

int main () {
        cin >> n;
        for ( int i = 0; i < n; i ++ ) 
                for ( int j = 0; j < n + 1; j ++ )
                        cin >> a[i][j];
        int t = Gauss();
        if ( t == 0 ) {
                for ( int i = 0; i < n; i ++ ) printf("%.2f\n", a[i][n]);
        } else if ( t == 1 ) puts("Infinite group solutions");
        else puts("No solution");
}
```

## 例题

**已知一个n维球体与其表面上n+1个点坐标，求球心坐标**  

n维太难想，考虑一下<span style="color:red;">2维圆</span>  
在上面任意取3个点 $(x1, y1),(x2, y2),(x3, y3)$ 与圆心 $(x0, y0)$  
得到一个公式：  

$\left\{\begin{aligned}
(x_1-x_0)^2+(y_1-y_0)^2=R^2\\
(x_2-x_0)^2+(y_2-y_0)^2=R^2\\
(x_3-x_0)^2+(y_3-y_0)^2=R^2
\end{aligned}\right.$  
  
那么此时我们就可以<span style="color: red;">拓展到n维</span>  
我们建立球心坐标 $[x_1,x_2,...x_n]$  
第i个点坐标 $[a_{i_1}, a_{i_2}, a_{i_3},...,a_{i_n}]$  
则有方程:  
$\left\{\begin{aligned}
&(a_{1_1}-x_1)^2+(a_{1_2}-x_2)^2+...+(a_{1_n}-x_n)^2=R^2\\
&(a_{2_1}-x_1)^2+(a_{2_2}-x_2)^2+...+(a_{2_n}-x_n)^2=R^2\\
&...\\
&(a_{n_1}-x_1)^2+(a_{n_2}-x_2)^2+...+(a_{n_n}-x_n)^2=R^2\\
&(a_{n+1_1}-x_1)^2+(a_{n+1_2}-x_2)^2+...+(a_{n+1_n}-x_n)^2=R^2
\end{aligned}\right.$   
解一下方程组就可以得到这个圆心坐标  
做减法将平方项消掉就可以变成一次方程  
减法可以先看二维下前两个式子相减  

即  
$\begin{aligned}
&\quad(a_{2}-x_1)^2-(a_{1}-x_1)^2=R^2-R^2\\
&\Rightarrow a_{2}^2-a_{1}^2-2(a_{2}-a_{1})x_1=0\\
&\Rightarrow a_{2}^2-a_{1}^2=2(a_{2}-a_{1})x_1
\end{aligned}$  

转换成朴素的可以变成： 
  
 $\left\{\begin{aligned}
&(2)-(1):\quad \stackrel{\color{blue}{b_{1_1}}}{2(a_{2_1}-a_{1_1})}x_1+\stackrel{\color{blue}b_{1_2}}{2(a_{2_2}-a{1_2})}x_2+...+2\stackrel{\color{blue}b_{1_3}}{(a_{2_n}-a_{1_n})}x_n=\stackrel{\color{blue}b_{1_{n+1}}}{a_{2_1}^2+a_{2_2}^2+...+a_{2_n}^2-a_{1_1}^2-a_{1_2}^2-...-a_{1_n}^2}\\
&(3)-(1):\\
&(4)-(1):\\
&...\\
&(n+1)-(1):\\
\end{aligned}\right.$  
n元一次线性方程组，剩下的交给高斯消元即可  
