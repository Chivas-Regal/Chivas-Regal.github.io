---
layout: post
title: 2-SAT问题
subtitle: 给了一张关系网，其中的某两个人有怎么样的关系呢？🤔
categories: 图论
tags: [建图、Kosaraju]
---

<head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
	<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
	</style>
        <style>
		.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
	</style>
</head>
<body class="vscode-body vscode-light">
<blockquote>
<p>导引：
A, B, C三人中有两个女生<br>
如果A是男生，那么B一定是女生：<br>
A和C性别相同<br>
求A B C三人的性别</p>
</blockquote>
<h2>定义</h2>  
要确定N个bool类型的值，使得其满足所有的限制关系（每个限制关系最多只对两个bool变量进行限制）<br>  
<br>
2-SAT问题是有多项式解法的，而3-SAT问题就是npc问题  
<h2>判断是否有解</h2> 
建立2N个点的有向图，不妨设  <br>
i点表示x[i] = false  <br>
i'点表示x[i] = true  <br>
一条 u -> v 的有向边表示如果选择了u，那么一定要选择v  <br>
不能出现i <--...--> i'<br>  
判断i和i'是否位于同一强连通分量即可 <br> 
<h2>输出可行方案</h2>  
如果从i点出发可以到达i'点，则旋律i会导致选i'，矛盾，因此只能选i'  <br>
Kosaraju算法在求强连通分量时顺带求出了一个遍历顺序q[1], q[2], ..., q[cnt]  <br>
只需要比较i和i'所属强连通分量在q中位置的前后关系即可构造出可行方案  <br>
<h3>一元限制的构图方案</h3>  
限制：x[i] = true  <br>
连边：i -> i'  <br>
表示如果i选了false那么i必须要是true<br>  
<h3>二元限制的构图方案</h3>  
一条边 u -> v的含义：若u则v<br>
命题“若u 则v”的逆否命题为“若非v 则非u”<br>  
命题于逆否命题等价  <br>
所以在建u -> v, 也要建v -> u'<br>  
所以对于每条二元限制，将其对应的命题与逆否命题的边连上，缺一不可  <br>
<blockquote>
<p>建图例：<br>
限制： u or v = true<br>
（有一个满足true就行）u-&gt;v', v-&gt;u'</p>
</blockquote>
<blockquote>
<p>建图例：<br>
限制：u or v = false<br>
（两者都要false回到一元限制关系）u'-&gt;u, v-&gt;v'</p>
</blockquote>
<blockquote>
<p>建图例：<br>
限制：u and v = false<br>
（两个没有同时满足）u'-&gt;v, v'-&gt;u</p>
</blockquote>
<blockquote>
<p>建图例：<br>
限制：u and v = true<br>
（两个都要满足）u'-&gt;u, v'-&gt;v</p>
</blockquote>
<blockquote>
<p>建图例：<br>
限制：u != v<br>
（两个情况不同）u'-&gt;v, u-&gt;v', v'-&gt;u, v-&gt;u'</p>
</blockquote>
<blockquote>
<p>建图例：<br>
限制：u == v<br>
（两个情况相同）u'-&gt;v', u-&gt;v, v'-&gt;u', v-&gt;u</p>
</blockquote>
<blockquote>
<p><strong>例题</strong><br>
有n对夫妻被邀请参加一个聚会，因为场地的问题，每对夫妻中只有1人可以列席<br>
在2n个人中，某些人之间有着很大矛盾（夫妻之间没有），主办方希望有矛盾的两个人不能同时出现在聚会上<br>
问有没有可能回有n个人同时列席？<br>
思路：<br>
建立2n个点的图，i点表示第i对夫妻是丈夫到场，i'点表示妻子到场<br>
如果A和B矛盾，则可以表示”若A则非B“、”若B则非A“。</p>
</blockquote>
<h2>强连通分量求出后的处理</h2>
<pre><code class="language-cpp"><div><span class="hljs-keyword">bool</span> res = <span class="hljs-number">1</span>;
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i ++){
    <span class="hljs-keyword">if</span>(nod[i] == nod[trans(i)]){
        res = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">break</span>;
    }
}
<span class="hljs-keyword">if</span>(res) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;YES&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
<span class="hljs-keyword">else</span>    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;NO&quot;</span>  &lt;&lt; <span class="hljs-built_in">endl</span>;

<span class="hljs-comment">//i&#x27;可以使用便宜量，表示为i + n(与带权并查集类似)</span>
</div></code></pre>
<h2>例题</h2> 
<blockquote>
<p>T个3人队伍，每个队伍有一个队长<br>
每个队伍要么队长回家，剩下两个留校，要么队长留校，剩下两人回家<br>
给定M条限制，每条限制指定两个人A和B，要求A和B不能同时留校<br>
判断是否有合法方案<br>
思路：<br>
建立6T个点的有向图，i点表示第i个人留校，i'点表示第i个人回家<br>
对于每个队伍x, y, z，其中x为队长<br>
x和y的选择不同，按照x!=y连边<br>
x和z的选择不同，按照x!=z连边<br>
y和z的选择不同，按照y==z连边<br>
对于每条限制A，B，两人不能同时留校<br>
若A留校，则B回家：A-&gt;B'<br>
若B留校，则A回家：B-&gt;A'</p>
</blockquote>
    </body>
