---
layout: post
title: ‰∏ªÂ∏≠Ê†ë
subtitle: Ë¶ÅÂèØ‰ª•Áõ¥Êé•ËÆøÈóÆÂà∞ÊØè‰∏ÄÊ¨°Á∫øÊÆµÊ†ëÁöÑÊîπÂèòÔºüü§î
categories: Êï∞ÊçÆÁªìÊûÑ
tags: [Êï∞ÊçÆÁªìÊûÑ]
---

<head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
	<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
	</style>
        <style>
		.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
	</style>
</head>
<body for="html-export">
      <div class="mume markdown-preview  ">
      <h2 class="mume-header" id="%E5%AE%9A%E4%B9%89">&#x5B9A;&#x4E49;</h2>

<p>&#x53EF;&#x6301;&#x4E45;&#x5316;&#x7EBF;&#x6BB5;&#x6811;&#x4E5F;&#x53EB;<span style="color: red;">&#x51FD;&#x6570;&#x5F0F;&#x7EBF;&#x6BB5;&#x6811;</span>&#x3001;&#x4E3B;&#x5E2D;&#x6811;<br>
&#x5176;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x4FEE;&#x6539;&#x5E76;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x5BF9;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x66F4;&#x6539;&#x5B83;&#x7684;&#x503C;<br>
&#x800C;&#x662F;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x989D;&#x5916;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x8868;&#x793A;&#x5B83;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x503C;&#xFF0C;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7248;&#x672C;&#x8282;&#x70B9;<br>
&#x5BF9;&#x4E8E;&#x8FD9;&#x4E2A;&#x7248;&#x672C;&#x8282;&#x70B9;&#xFF0C;&#x4F9D;&#x7136;<span style="color: red;">&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x5B83;&#x7684;&#x5DE6;&#x53F3;&#x5B50;&#x8282;&#x70B9;&#x3001;&#x4E5F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x5B83;</span></p>
<h2 class="mume-header" id="%E5%8F%AF%E6%8C%81%E4%B9%85%E5%89%8D%E6%8F%90">&#x53EF;&#x6301;&#x4E45;&#x524D;&#x63D0;</h2>

<p>&#x672C;&#x8EAB;&#x7684;&#x62D3;&#x6251;&#x7ED3;&#x6784;&#x5728;&#x6574;&#x4E2A;&#x64CD;&#x4F5C;&#x4E2D;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;</p>
<blockquote>
<p>&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF0C;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x5B57;&#x5178;&#x6811;&#xFF0C;&#x5E76;&#x67E5;&#x96C6;&#xFF0C;&#x5806;....&#x90FD;&#x6EE1;&#x8DB3;<br>
&#x4F46;&#x5E73;&#x8861;&#x6811;&#x4E0D;&#x53EF;&#xFF0C;&#x5E73;&#x8861;&#x6811;&#x6709;&#x5DE6;&#x65CB;&#x53F3;&#x65CB;&#xFF0C;&#x8282;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x62D3;&#x6251;&#x5E8F;&#x4F1A;&#x53D8;</p>
</blockquote>
<h2 class="mume-header" id="%E6%93%8D%E4%BD%9C">&#x64CD;&#x4F5C;</h2>

<h3 class="mume-header" id="%E6%9F%A5%E8%AF%A2">&#x67E5;&#x8BE2;</h3>

<p>&#x5BF9;&#x4E8E;&#x6BCF;&#x6B21;&#x67E5;&#x8BE2;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;<span style="color: red;">&#x786E;&#x5B9A;&#x7248;&#x672C;</span><br>
&#x5BF9;&#x4E8E;&#x67D0;&#x4E2A;&#x7248;&#x672C;&#x4E0B;&#x7684;&#x6811;&#xFF0C;&#x5229;&#x7528;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x4E8C;&#x5206;&#x6027;&#x8D28;&#xFF0C;&#x4E8C;&#x5206;&#x5730;&#x5411;&#x4E0B;&#x67E5;&#x8BE2;&#xFF08;&#x548C;&#x666E;&#x901A;&#x7684;&#x5DEE;&#x4E0D;&#x591A;&#xFF09;</p>
<h3 class="mume-header" id="%E4%BF%AE%E6%94%B9">&#x4FEE;&#x6539;</h3>

<p>&#x6BCF;&#x6B21;&#x5355;&#x70B9;&#x4FEE;&#x6539;&#x4F1A;&#x6539;&#x53D8;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">logn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span></span></span></span>&#x4E2A;&#x8282;&#x70B9;<br>
&#x56E0;&#x4E3A;&#x5411;&#x4E0B;&#x9012;&#x5F52;&#xFF0C;&#x627E;&#x5230;&#x8981;&#x4FEE;&#x6539;&#x7684;&#x70B9;&#x540E;&#xFF0C;&#x4E00;&#x6B65;&#x6B65;&#x5411;&#x4E0A;<br>
<span style="color: red;">&#x4ECE;&#x5F53;&#x524D;&#x8282;&#x70B9;&#x5230;&#x6839;&#x8282;&#x70B9;</span>&#x7684;&#x4E00;&#x6761;&#x8DEF;&#x5F84;&#x4E0A;&#x90FD;&#x8981;&#x4FEE;&#x6539;</p>
<p>&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x5F88;&#x96BE;&#x5B9E;&#x73B0;&#xFF0C;&#x61D2;&#x6807;&#x8BB0;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x6C38;&#x4E45;&#x5316;&#x61D2;&#x6807;&#x8BB0;&#x8FDB;&#x884C;&#x7EF4;&#x62A4;</p>
<h2 class="mume-header" id="%E7%BB%8F%E5%85%B8%E9%97%AE%E9%A2%98%E5%8C%BA%E9%97%B4%E7%AC%ACk%E5%B0%8F">&#x7ECF;&#x5178;&#x95EE;&#x9898;&#xFF1A;&#x533A;&#x95F4;&#x7B2C;k&#x5C0F;</h2>

<p><a href="https://www.luogu.com.cn/problem/P3834"><img src="https://i.loli.net/2021/09/23/Hi18j6T7kqRYOhl.png"></a></p>
<h3 class="mume-header" id="%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%E6%9D%83%E5%80%BC%E7%BA%BF%E6%AE%B5%E6%A0%91">&#x524D;&#x7F6E;&#x77E5;&#x8BC6;&#xFF1A;&#x6743;&#x503C;&#x7EBF;&#x6BB5;&#x6811;</h3>

<p><b><span style="color: red;">&#x5BF9;&#x503C;&#x57DF;&#x5185;&#x6BCF;&#x4E2A;&#x6570;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6811;&#x5EFA;&#x7ACB;&#x7EBF;&#x6BB5;&#x6811;</span></b></p>
<blockquote>
<p>&#x6BD4;&#x5982;&#x8BF4;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mtext>&#x2005;&#x200A;</mtext><mn>1</mn><mtext>&#x2005;&#x200A;</mtext><mn>2</mn><mtext>&#x2005;&#x200A;</mtext><mn>2</mn><mtext>&#x2005;&#x200A;</mtext><mn>3</mn><mtext>&#x2005;&#x200A;</mtext><mn>3</mn><mtext>&#x2005;&#x200A;</mtext><mn>3</mn><mtext>&#x2005;&#x200A;</mtext><mn>3</mn><mtext>&#x2005;&#x200A;</mtext><mn>4</mn><mtext>&#x2005;&#x200A;</mtext><mn>5</mn></mrow><annotation encoding="application/x-tex">1\;1\;2\;2\;3\;3\;3\;3\;4\;5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">5</span></span></span></span>&#x8FD9;&#x4E2A;&#x5E8F;&#x5217;<br>
&#x4F1A;&#x5F62;&#x6210;&#x8FD9;&#x6837;&#x4E00;&#x68F5;&#x6743;&#x503C;&#x7EBF;&#x6BB5;&#x6811;<br>
<img src="https://i.loli.net/2021/09/23/Yo1PiewFNVyns6W.png"><br>
&#x60F3;&#x8981;&#x6C42;&#x5F97;&#x6B64;&#x5E8F;&#x5217;&#x4E2D;&#x7684;&#x7B2C;k&#x5C0F;&#xFF0C;&#x6B64;&#x65F6;&#x5229;&#x7528;&#x6743;&#x503C;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x6027;&#x8D28;<br>
&#x6211;&#x4EEC;&#x53EF;&#x4EE5;<span style="color: red;">&#x4E8C;&#x5206;&#x5730;</span>&#x5F80;&#x4E0B;&#x8D70;<br>
&#x82E5;&#x5DE6;&#x4FA7;&#x7684;&#x4E2A;&#x6570;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2265;</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\ge k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">&#x2265;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>&#xFF0C;&#x8D70;&#x5DE6;&#x4FA7;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span><br>
&#x82E5;&#x5DE6;&#x4FA7;&#x7684;&#x4E2A;&#x6570;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\lt k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>&#xFF0C;&#x8D70;&#x53F3;&#x4FA7;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>&#x2212;</mo><mi>c</mi><mi>n</mi><msub><mi>t</mi><mi>l</mi></msub><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(k-cnt_left)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><br>
&#x8D70;&#x5230;&#x6700;&#x540E;&#x5C31;&#x662F;&#x7B2C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>&#x5C0F;</p>
</blockquote>
<h3 class="mume-header" id="%E5%BF%AB%E9%80%9F%E6%B1%82%E5%8C%BA%E9%97%B4%E6%9D%83%E5%80%BC%E7%BA%BF%E6%AE%B5%E6%A0%91">&#x5FEB;&#x901F;&#x6C42;&#x533A;&#x95F4;&#x6743;&#x503C;&#x7EBF;&#x6BB5;&#x6811;</h3>

<p>&#x7531;&#x4E8E;&#x662F;&#x533A;&#x95F4;&#x67E5;&#x8BE2;<br>
&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x8054;&#x60F3;&#x5230;<span style="color: red;">&#x524D;&#x7F00;&#x5904;&#x7406;</span><br>
&#x5373;&#x6784;&#x5EFA;&#x4E00;&#x68F5;&#x524D;&#x7F00;&#x7684;&#x6743;&#x503C;&#x7EBF;&#x6BB5;&#x6811;<br>
&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5728;<span style="color: red;">&#x8BBF;&#x95EE;&#x533A;&#x95F4;&#x6743;&#x503C;&#x7EBF;&#x6BB5;&#x6811;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x4E24;&#x4E2A;&#x524D;&#x7F00;&#x76F8;&#x51CF;&#x5FEB;&#x901F;&#x6C42;&#x5F97;</span><br>
<b>&#x76F8;&#x51CF;&#x64CD;&#x4F5C;&#x5305;&#x62EC;&#x8BBF;&#x95EE;&#x64CD;&#x4F5C;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x7528;&#x4E3B;&#x5E2D;&#x6811;&#x53BB;&#x5B9E;&#x73B0;</b><br>
&#x5BF9;&#x4E8E;&#x5E8F;&#x5217;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x79BB;&#x6563;&#x5316;&#x4E4B;&#x540E;&#x7684;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x53EF;&#x4EE5;&#x5C06;<span style="color: red;">&#x63D2;&#x5165;&#x89C6;&#x4F5C;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x65B0;&#x7248;&#x672C;</span><br>
&#x5728;&#x67E5;&#x8BE2;&#x533A;&#x95F4;&#x7684;&#x65F6;&#x5019;&#x53EA;&#x9700;&#x8981;<span style="color: red;">&#x67E5;&#x8BE2;&#x4E24;&#x4E2A;&#x7248;&#x672C;</span>&#x5373;&#x53EF;</p>
<h3 class="mume-header" id="%E7%A8%8B%E5%BA%8F">&#x7A0B;&#x5E8F;</h3>

<pre data-role="codeBlock" data-info="cpp" class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">2e5</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> a<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> nums<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">node</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>sgtr<span class="token punctuation">[</span>N <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> tot<span class="token punctuation">,</span> root<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// &#x8BBF;&#x95EE;x&#x79BB;&#x6563;&#x5316;&#x4E4B;&#x540E;&#x7684;&#x503C;</span>
<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">get_Id</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">lower_bound</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">-</span> nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x5728;&#x8868;&#x793A;[l, r]&#x533A;&#x95F4;&#x7684;now&#x8282;&#x70B9;&#x63D2;&#x5165;&#x6570;&#x5B57;p&#xFF0C;&#x4E0A;&#x4E2A;&#x7248;&#x672C;&#x662F;pre</span>
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">Insert</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> pre<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>now<span class="token punctuation">,</span> <span class="token keyword">int</span> p <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sgtr<span class="token punctuation">[</span><span class="token operator">++</span> tot<span class="token punctuation">]</span> <span class="token operator">=</span> sgtr<span class="token punctuation">[</span>pre<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token comment">// &#x5F88;&#x591A;&#x4FE1;&#x606F;&#x4E00;&#x6837;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x6539;&#x6539;&#x5C31;&#x884C;</span>
        now <span class="token operator">=</span> tot<span class="token punctuation">;</span>                      <span class="token comment">// &#x5F53;&#x524D;&#x8282;&#x70B9;&#x7F16;&#x53F7; = &#x65B0;&#x5206;&#x914D;&#x7684;&#x8282;&#x70B9;&#x7F16;&#x53F7;</span>
        sgtr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>sum <span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token comment">//&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x6570;&#x5B57;&#x7684;&#x4E2A;&#x6570;+1</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> l <span class="token operator">==</span> r <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span>          <span class="token comment">// &#x53F6;&#x5B50;&#x8282;&#x70B9;</span>

        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> p <span class="token operator">&lt;=</span> mid <span class="token punctuation">)</span>                 <span class="token comment">// &#x63D2;&#x5165;&#x4EC0;&#x4E48;&#x6570; = &#x5728;&#x7EBF;&#x6BB5;&#x6811;&#x54EA;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;&#x63D2;&#x5165;</span>
                <span class="token function">Insert</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> sgtr<span class="token punctuation">[</span>pre<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">,</span> sgtr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
                <span class="token function">Insert</span><span class="token punctuation">(</span>mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> sgtr<span class="token punctuation">[</span>pre<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">,</span> sgtr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x67E5;&#x8BE2;&#x7248;&#x672C;R-&#x7248;&#x672C;L-1&#xFF0C;&#x4E24;&#x4E2A;&#x7248;&#x672C;&#x540C;&#x6B65;&#x8FDB;&#x884C;&#xFF0C;&#x5F53;&#x524D;&#x5230;&#x8FBE;&#x8282;&#x70B9;&#x8868;&#x793A;&#x533A;&#x95F4;[l,r]&#xFF0C;&#x67E5;&#x8BE2;&#x7B2C;k&#x5927;</span>
<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">Query</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> R<span class="token punctuation">,</span> <span class="token keyword">int</span> k <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> l <span class="token operator">==</span> r <span class="token punctuation">)</span> <span class="token keyword">return</span> l<span class="token punctuation">;</span>

        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> cnt <span class="token operator">=</span> sgtr<span class="token punctuation">[</span>sgtr<span class="token punctuation">[</span>R<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>sum <span class="token operator">-</span> sgtr<span class="token punctuation">[</span>sgtr<span class="token punctuation">[</span>L<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>sum<span class="token punctuation">;</span> <span class="token comment">// &#x65B0;&#x51CF;&#x51FA;&#x7684;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x5DE6;&#x5B50;&#x6811;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x6570;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> k <span class="token operator">&lt;=</span> cnt <span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token function">Query</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> sgtr<span class="token punctuation">[</span>L<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">,</span> sgtr<span class="token punctuation">[</span>R<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
                <span class="token keyword">return</span> <span class="token function">Query</span><span class="token punctuation">(</span>mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> sgtr<span class="token punctuation">[</span>L<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">,</span> sgtr<span class="token punctuation">[</span>R<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">,</span> k <span class="token operator">-</span> cnt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">ONLINE_JUDGE</span></span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">&quot;../in.in&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">&quot;../out.out&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
        <span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">;</span> cin <span class="token operator">&gt;&gt;</span> n <span class="token operator">&gt;&gt;</span> m<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cin <span class="token operator">&gt;&gt;</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                nums<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">sort</span> <span class="token punctuation">(</span> nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        nums<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token function">unique</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> root<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">get_Id</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x63D2;&#x5165;&#xFF0C;&#x540C;&#x65F6;&#x8D4B;&#x503C;&#x7B2C;i&#x4E2A;&#x6570;&#x5F62;&#x6210;&#x7684;&#x7248;&#x672C;&#x662F;&#x51E0;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span> m <span class="token operator">--</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> k<span class="token punctuation">;</span> cin <span class="token operator">&gt;&gt;</span> l <span class="token operator">&gt;&gt;</span> r <span class="token operator">&gt;&gt;</span> k<span class="token punctuation">;</span>
                cout <span class="token operator">&lt;&lt;</span> nums<span class="token punctuation">[</span><span class="token function">Query</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> root<span class="token punctuation">[</span>l <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> root<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
      </div>
    </body>
